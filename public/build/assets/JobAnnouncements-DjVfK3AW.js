import{al as oe,i as T,N as F,r as $,G as ne,q as Y,c as N,y as H,h as b,z as L,j as J,w as u,g as a,d as h,u as v,b as B,f as G,l as j,t as y,s as le,a0 as re,F as ie}from"./_plugin-vue_export-helper-P6s7mfAX.js";import{H as de}from"./Header-Dc2gjrUc.js";import{l as m,u as K,a as ce}from"./admin-C1tUPR0Q.js";import{T as E,a as ue}from"./TranslationField-DYZ6aUjw.js";/* empty css                                                               *//* empty css              */let z=oe("JobAnnouncementRepository",{state(){return{isEditMode:$(!1),router:ne(),search:$(""),loadingTable:$(!0),loading:$(!0),totalItems:$(0),selectedItems:$([]),itemsPerPage:$(5),createDialog:$(!1),jobs:F([]),jobSearch:$(""),currentJob:F({}),statusOptions:F([{value:"draft",label:"Draft"},{value:"open",label:"Open"},{value:"closed",label:"Closed"},{value:"archived",label:"Archived"}])}},actions:{setEditMode(d){this.isEditMode=d},getTodaysDate(){const d=new Date,t=d.getFullYear(),r=String(d.getMonth()+1).padStart(2,"0"),i=String(d.getDate()).padStart(2,"0");return`${t}-${r}-${i}`},async fetchJobs({page:d=1,itemsPerPage:t=5,status:r=""}){this.loading=!0;try{const i={page:d,perPage:t,search:this.jobSearch,status:r},q=await T.get("job-announcements",{params:i});q.data.success?(this.jobs=q.data.data,this.totalItems=q.data.meta.total):m.error("Failed to fetch job announcements")}catch{m.error("Error fetching job announcements")}finally{this.loading=!1}},async createJob(d){try{const t=await T.post("job-announcements",d);if(t.data.success)return m.success("Job announcement created successfully"),this.createDialog=!1,this.resetCurrentJob(),this.fetchJobs({page:1,itemsPerPage:this.itemsPerPage}),t.data.data;m.error("Failed to create job announcement")}catch(t){t.response?.data?.message?m.error(t.response.data.message):m.error("Error creating job announcement")}},async updateJob(d,t){try{const r=await T.put(`job-announcements/${d}`,t);if(r.data.success)return m.success("Job announcement updated successfully"),this.createDialog=!1,this.resetCurrentJob(),this.fetchJobs({page:1,itemsPerPage:this.itemsPerPage}),r.data.data;m.error("Failed to update job announcement")}catch(r){r.response?.data?.message?m.error(r.response.data.message):m.error("Error updating job announcement")}},async deleteJob(d){try{(await T.delete(`job-announcements/${d}`)).data.success?(m.success("Job announcement deleted successfully"),this.fetchJobs({page:1,itemsPerPage:this.itemsPerPage})):m.error("Failed to delete job announcement")}catch(t){t.response?.data?.message?m.error(t.response.data.message):m.error("Error deleting job announcement")}},async bulkDeleteJobs(d){try{(await T.post("job-announcements/bulk-delete",{ids:d})).data.success?(m.success(`${d.length} job announcements deleted successfully`),this.fetchJobs({page:1,itemsPerPage:this.itemsPerPage})):m.error("Failed to delete job announcements")}catch(t){t.response?.data?.message?m.error(t.response.data.message):m.error("Error deleting job announcements")}},async toggleStatus(d){try{(await T.patch(`job-announcements/${d}/toggle-status`)).data.success?(m.success("Job announcement status updated successfully"),this.fetchJobs({page:1,itemsPerPage:this.itemsPerPage})):m.error("Failed to update job announcement status")}catch(t){t.response?.data?.message?m.error(t.response.data.message):m.error("Error updating job announcement status")}},async getJob(d){this.loading=!0;try{const t=await T.get(`job-announcements/${d}`,{params:{include_translations:1}});if(t.data&&t.data.success)return this.currentJob=t.data.data,this.loading=!1,t.data.data;{this.loading=!1;const r=t.data?.message||"Failed to fetch job announcement";throw m.error(r),new Error(r)}}catch(t){this.loading=!1;const r=t.response?.data?.message||t.message||"Error fetching job announcement";throw m.error(r),t}},resetCurrentJob(){this.currentJob={title:"",slug:"",description:"",requirements:"",location:"",salary_range:"",deadline:this.getTodaysDate(),status:"draft",farsi_translations:{title:"",location:"",description:"",requirements:""},pashto_translations:{title:"",location:"",description:"",requirements:""}}},getStatusLabel(d){const t=this.statusOptions.find(r=>r.value===d);return t?t.label:d},getStatusColor(d){return{draft:"warning",open:"success",closed:"error",archived:"grey"}[d]||"primary"}}});z();const me={class:"flex w-100"},pe={class:"flex w-100"},ge={class:"flex w-100"},fe={class:"flex w-100"},be={class:"flex w-100"},he={__name:"CreateJobAnnouncement",setup(d){const{t}=K(),r=z(),i=N(()=>r.isEditMode?t("edit_job_announcement"):t("create_job_announcement")),q=N(()=>r.isEditMode?t("update"):t("create")),C=$(!1),A=["title","location","description","requirements"],n=F({id:null,title:"",slug:"",description:"",requirements:"",location:"",salary_range:"",deadline:"",status:"draft",farsi_translations:{},pashto_translations:{}}),c=F({title:"",location:"",description:"",requirements:""}),l=F({title:"",location:"",description:"",requirements:""});H(()=>r.currentJob,async(e,s)=>{if(s!==e)if(e&&Object.keys(e).length>0&&e.id){if(n.id=e.id||null,n.title=e.title||"",n.slug=e.slug||"",n.description=e.description||"",n.requirements=e.requirements||"",n.location=e.location||"",n.salary_range=e.salary_range||"",e.deadline){const _=new Date(e.deadline);isNaN(_.getTime())?n.deadline=e.deadline:n.deadline=_.toISOString().split("T")[0]}else n.deadline="";n.status=e.status||"draft";let f={},V={};if(e.farsi_translations)try{f=typeof e.farsi_translations=="string"?JSON.parse(e.farsi_translations):e.farsi_translations}catch{f={}}if(e.pashto_translations)try{V=typeof e.pashto_translations=="string"?JSON.parse(e.pashto_translations):e.pashto_translations}catch{V={}}n.farsi_translations=f,n.pashto_translations=V,n.translationData={...e,farsi_translations:f,pashto_translations:V},c.title=f.title||"",c.location=f.location||"",c.description=f.description||"",c.requirements=f.requirements||"",l.title=V.title||"",l.location=V.location||"",l.description=V.description||"",l.requirements=V.requirements||"",await new Promise(_=>setTimeout(_,100))}else e&&Object.keys(e).length===0&&M()},{deep:!0,immediate:!0}),H(()=>r.createDialog,e=>{e||M()});const M=()=>{n.id=null,n.title="",n.slug="",n.description="",n.requirements="",n.location="",n.salary_range="",n.deadline="",n.status="draft",n.farsi_translations={},n.pashto_translations={},c.title="",c.location="",c.description="",c.requirements="",l.title="",l.location="",l.description="",l.requirements=""},O=()=>{n.title&&!n.slug&&(n.slug=n.title.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim("-"))},w=e=>c[e]&&c[e].trim()!=="",U=e=>l[e]&&l[e].trim()!=="",k=e=>{c[e]=""},S=e=>{l[e]=""},x=async e=>{C.value=!0;try{const s={farsi:{title:c.title||"",location:c.location||"",description:c.description||"",requirements:c.requirements||""},pashto:{title:l.title||"",location:l.location||"",description:l.description||"",requirements:l.requirements||""}},f={...n,translations:s};delete f.translationData,r.isEditMode?await r.updateJob(n.id,f):await r.createJob(f)}catch{}finally{C.value=!1}},I={required:e=>!!e||t("field_required")};return(e,s)=>{const f=b("v-text-field"),V=b("v-select"),_=b("v-textarea");return J(),L(ue,{modelValue:v(r).createDialog,"onUpdate:modelValue":s[8]||(s[8]=p=>v(r).createDialog=p),"form-title":i.value,"button-text":q.value,"translatable-fields":A,"form-data":n,rules:I,saving:C.value,"is-edit-mode":v(r).isEditMode,onSave:x},{"base-fields":u(({formData:p,rules:P})=>[h("div",me,[a(f,{modelValue:p.title,"onUpdate:modelValue":o=>p.title=o,variant:"outlined",label:e.$t("title"),density:"compact",class:"pb-4 pr-2 w-75",rules:[P.required],onInput:O},null,8,["modelValue","onUpdate:modelValue","label","rules"]),a(V,{modelValue:p.status,"onUpdate:modelValue":o=>p.status=o,items:v(r).statusOptions,variant:"outlined",density:"compact","item-value":"value","item-title":"label","return-object":!1,label:e.$t("status"),class:"pb-4 pl-2 w-25",rules:[P.required]},null,8,["modelValue","onUpdate:modelValue","items","label","rules"])]),h("div",pe,[a(f,{modelValue:p.slug,"onUpdate:modelValue":o=>p.slug=o,variant:"outlined",label:e.$t("slug"),density:"compact",class:"pb-4 pr-2 w-50",hint:e.$t("hint_url_friendly")},null,8,["modelValue","onUpdate:modelValue","label","hint"]),a(f,{modelValue:p.location,"onUpdate:modelValue":o=>p.location=o,variant:"outlined",label:e.$t("location"),density:"compact",class:"pb-4 pl-2 w-50",rules:[P.required]},null,8,["modelValue","onUpdate:modelValue","label","rules"])]),h("div",ge,[a(_,{modelValue:p.description,"onUpdate:modelValue":o=>p.description=o,variant:"outlined",label:e.$t("description"),density:"compact",class:"pb-4 w-100",rules:[P.required],rows:"4"},null,8,["modelValue","onUpdate:modelValue","label","rules"])]),h("div",fe,[a(_,{modelValue:p.requirements,"onUpdate:modelValue":o=>p.requirements=o,variant:"outlined",label:e.$t("requirements"),density:"compact",class:"pb-4 w-100",rows:"3"},null,8,["modelValue","onUpdate:modelValue","label"])]),h("div",be,[a(f,{modelValue:p.salary_range,"onUpdate:modelValue":o=>p.salary_range=o,variant:"outlined",label:e.$t("salary_range"),density:"compact",class:"pb-4 pr-2 w-50"},null,8,["modelValue","onUpdate:modelValue","label"]),a(f,{modelValue:p.deadline,"onUpdate:modelValue":o=>p.deadline=o,variant:"outlined",label:e.$t("application_deadline"),density:"compact",class:"pb-4 pl-2 w-50",type:"date",rules:[P.required]},null,8,["modelValue","onUpdate:modelValue","label","rules"])])]),"farsi-fields":u(({formData:p,rules:P})=>[a(E,{modelValue:c.title,"onUpdate:modelValue":s[0]||(s[0]=o=>c.title=o),"field-name":"title","field-label":e.$t("title"),language:"farsi","language-label":e.$t("farsi"),"has-translation":w("title"),onClear:k},null,8,["modelValue","field-label","language-label","has-translation"]),a(E,{modelValue:c.location,"onUpdate:modelValue":s[1]||(s[1]=o=>c.location=o),"field-name":"location","field-label":e.$t("location"),language:"farsi","language-label":e.$t("farsi"),"has-translation":w("location"),onClear:k},null,8,["modelValue","field-label","language-label","has-translation"]),a(E,{modelValue:c.description,"onUpdate:modelValue":s[2]||(s[2]=o=>c.description=o),"field-name":"description","field-label":e.$t("description"),language:"farsi","language-label":e.$t("farsi"),"field-type":"textarea",rows:4,"has-translation":w("description"),onClear:k},null,8,["modelValue","field-label","language-label","has-translation"]),a(E,{modelValue:c.requirements,"onUpdate:modelValue":s[3]||(s[3]=o=>c.requirements=o),"field-name":"requirements","field-label":e.$t("requirements"),language:"farsi","language-label":e.$t("farsi"),"field-type":"textarea",rows:3,"has-translation":w("requirements"),onClear:k},null,8,["modelValue","field-label","language-label","has-translation"])]),"pashto-fields":u(({formData:p,rules:P})=>[a(E,{modelValue:l.title,"onUpdate:modelValue":s[4]||(s[4]=o=>l.title=o),"field-name":"title","field-label":e.$t("title"),language:"pashto","language-label":e.$t("pashto"),"has-translation":U("title"),onClear:S},null,8,["modelValue","field-label","language-label","has-translation"]),a(E,{modelValue:l.location,"onUpdate:modelValue":s[5]||(s[5]=o=>l.location=o),"field-name":"location","field-label":e.$t("location"),language:"pashto","language-label":e.$t("pashto"),"has-translation":U("location"),onClear:S},null,8,["modelValue","field-label","language-label","has-translation"]),a(E,{modelValue:l.description,"onUpdate:modelValue":s[6]||(s[6]=o=>l.description=o),"field-name":"description","field-label":e.$t("description"),language:"pashto","language-label":e.$t("pashto"),"field-type":"textarea",rows:4,"has-translation":U("description"),onClear:S},null,8,["modelValue","field-label","language-label","has-translation"]),a(E,{modelValue:l.requirements,"onUpdate:modelValue":s[7]||(s[7]=o=>l.requirements=o),"field-name":"requirements","field-label":e.$t("requirements"),language:"pashto","language-label":e.$t("pashto"),"field-type":"textarea",rows:3,"has-translation":U("requirements"),onClear:S},null,8,["modelValue","field-label","language-label","has-translation"])]),_:1},8,["modelValue","form-title","button-text","form-data","saving","is-edit-mode"])}}},ve=Y(he,[["__scopeId","data-v-1798a880"]]),_e=["dir"],ye={class:"btn-search pt-12 pb-6"},Ve={class:"text-field w-25"},$e={class:"flex"},je={class:"table-section"},Pe={class:"py-2 pl-4 d-flex align-center"},qe={class:"font-weight-medium"},Ee={class:"text-caption text-grey"},Te={class:"py-2 pl-4"},Ce={class:"py-2 pl-4"},we={class:"text-caption"},Ue={key:0,class:"text-caption text-success"},ke={key:1,class:"text-caption text-error"},Se={__name:"JobAnnouncements",setup(d){const{t,locale:r}=K();ce();const i=z(),q=N(()=>["fa","ps"].includes(r.value)?"rtl":"ltr"),C=$("");let A;const n=()=>{clearTimeout(A),A=setTimeout(()=>{i.fetchJobs({page:1,itemsPerPage:i.itemsPerPage,status:C.value})},500)},c=e=>{i.fetchJobs({page:e.page,itemsPerPage:e.itemsPerPage,status:C.value})},l=$([]),M=()=>{l.value.length>0&&(i.bulkDeleteJobs(l.value),l.value=[])},O=()=>{i.resetCurrentJob(),i.isEditMode=!1,i.createDialog=!0},w=async e=>{try{i.isEditMode=!0,await i.getJob(e.id),i.createDialog=!0}catch{i.isEditMode=!1}},U=async e=>{await i.deleteJob(e.id)},k=async e=>{await i.toggleStatus(e.id)},S=e=>{switch(e){case"open":return"success";case"draft":return"warning";case"closed":return"error";case"archived":return"grey";default:return"primary"}},x=e=>new Date(e).toLocaleDateString(),I=N(()=>[{title:"",key:"checkbox",align:"start",sortable:!1},{title:t("title"),key:"title",align:"start",sortable:!0},{title:t("status"),key:"status",align:"center",sortable:!0},{title:t("deadline"),key:"deadline",align:"center",sortable:!0},{title:t("created_date"),key:"created_at",align:"center",sortable:!0},{title:t("action"),key:"action",align:"center",sortable:!1}]);return(e,s)=>{const f=b("v-divider"),V=b("v-text-field"),_=b("v-btn"),p=b("v-chip"),P=b("v-checkbox"),o=b("v-icon"),R=b("v-list-item-title"),Q=b("v-list-item"),W=b("v-list"),X=b("v-menu"),Z=b("v-data-table-server"),ee=b("v-col"),te=b("v-row"),ae=b("v-main"),se=b("v-app");return J(),B(ie,null,[v(i).createDialog?(J(),L(ve,{key:0})):G("",!0),h("div",{dir:q.value},[a(de,{pageTitle:e.$t("job_announcements_management")},null,8,["pageTitle"]),a(f,{thickness:1,class:"border-opacity-100"}),h("div",ye,[h("div",Ve,[a(V,{color:"primary",density:"compact",variant:"outlined",label:e.$t("search"),"append-inner-icon":"mdi-magnify","hide-details":"",modelValue:v(i).jobSearch,"onUpdate:modelValue":s[0]||(s[0]=g=>v(i).jobSearch=g),onInput:n},null,8,["label","modelValue"])]),h("div",$e,[a(_,{class:"action-btn-success"},{default:u(()=>[j(y(v(t)("filter")),1)]),_:1}),s[3]||(s[3]=j(" Â  ",-1)),a(_,{onClick:le(O,["stop"]),variant:"flat",class:"action-btn-success"},{default:u(()=>[j(y(v(t)("create")),1)]),_:1})])]),h("div",je,[a(se,null,{default:u(()=>[a(ae,{class:"main"},{default:u(()=>[a(te,null,{default:u(()=>[a(ee,null,{default:u(()=>[a(Z,{dir:q.value,theme:"cursor-pointer","items-per-page":v(i).itemsPerPage,"onUpdate:itemsPerPage":s[2]||(s[2]=g=>v(i).itemsPerPage=g),headers:I.value,"items-length":v(i).totalItems,items:v(i).jobs,loading:v(i).loading,"onUpdate:options":c,hover:"",class:"w-100 mx-auto"},{"item.title":u(({item:g})=>[h("div",Pe,[h("div",null,[h("div",qe,y(g.title),1),h("div",Ee,y(g.location),1)])])]),"item.status":u(({item:g})=>[h("div",Te,[a(p,{color:S(g.status),size:"small",variant:"flat"},{default:u(()=>[j(y(v(i).getStatusLabel(g.status)),1)]),_:2},1032,["color"])])]),"item.deadline":u(({item:g})=>[h("div",Ce,[h("div",we,y(x(g.deadline)),1),g.days_remaining>0?(J(),B("div",Ue,y(g.days_remaining)+" "+y(e.$t("days_left")),1)):(J(),B("div",ke,y(e.$t("expired")),1))])]),"item.checkbox":u(({item:g})=>[a(P,{value:g.id,modelValue:l.value,"onUpdate:modelValue":s[1]||(s[1]=D=>l.value=D),class:"w-6 d-flex"},null,8,["value","modelValue"])]),"item.action":u(({item:g})=>[a(X,null,{activator:u(({props:D})=>[a(_,re({icon:"mdi-dots-vertical"},D,{variant:"text"}),null,16)]),default:u(()=>[a(W,null,{default:u(()=>[a(Q,null,{default:u(()=>[a(R,{onClick:D=>w(g),class:"cursor-pointer d-flex gap-3 justify-left pb-3"},{default:u(()=>[a(o,{color:"tealColor"},{default:u(()=>[...s[4]||(s[4]=[j("mdi-square-edit-outline",-1)])]),_:1}),j(" "+y(e.$t("edit")),1)]),_:1},8,["onClick"]),a(R,{onClick:D=>k(g),class:"cursor-pointer d-flex gap-3 pb-3"},{default:u(()=>[a(o,{color:g.status==="open"?"orange":"green"},{default:u(()=>[j(y(g.status==="open"?"mdi-eye-off":"mdi-eye"),1)]),_:2},1032,["color"]),j(" "+y(g.status==="open"?e.$t("close"):e.$t("open")),1)]),_:2},1032,["onClick"]),a(R,{class:"cursor-pointer d-flex gap-3",onClick:D=>U(g)},{default:u(()=>[a(o,{color:"error"},{default:u(()=>[...s[5]||(s[5]=[j("mdi-delete-outline",-1)])]),_:1}),j(" "+y(e.$t("delete")),1)]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1},8,["dir","items-per-page","headers","items-length","items","loading"]),l.value.length>0?(J(),L(_,{key:0,class:"header-button",onClick:M,color:"#B71C1C",flat:"",inset:"",text:v(t)("delete_selected",{count:l.value.length})},null,8,["text"])):G("",!0)]),_:1})]),_:1})]),_:1})]),_:1})])],8,_e)],64)}}},Oe=Y(Se,[["__scopeId","data-v-bde28de6"]]);export{Oe as default};
