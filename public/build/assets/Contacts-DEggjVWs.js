import{al as pe,i as $,N as D,r as f,G as ve,q as _e,c as B,o as ge,h as d,b as S,j as y,d as a,g as r,u as v,w as o,z as j,f as b,l as _,t as n,a0 as fe,F as he}from"./_plugin-vue_export-helper-BPPfTR4S.js";import{H as ye}from"./Header-CgJPtGh2.js";import{l as m,u as be,a as ke}from"./admin-BgzI1_lQ.js";/* empty css                                                               *//* empty css              */let Ce=pe("ContactsRepository",{state(){return{router:ve(),search:f(""),loadingTable:f(!0),loading:f(!0),totalItems:f(0),selectedItems:f([]),itemsPerPage:f(15),contacts:D([]),contactSearch:f(""),currentContact:D({}),statusOptionsBase:[{value:"",labelKey:"all_status"},{value:"new",labelKey:"new"},{value:"read",labelKey:"read"},{value:"replied",labelKey:"replied"},{value:"archived",labelKey:"archived"}],subjectOptionsBase:[{value:"",labelKey:"all_types"},{value:"job_application",labelKey:"contact.job_application"},{value:"general_inquiry",labelKey:"contact.general_inquiry"},{value:"project_discussion",labelKey:"contact.project_discussion"},{value:"technical_support",labelKey:"contact.technical_support"},{value:"partnership",labelKey:"contact.partnership"},{value:"media_inquiry",labelKey:"contact.media_inquiry"},{value:"other",labelKey:"contact.other"}]}},actions:{getStatusLabel(u,e){const p=e||(g=>g),s=this.statusOptionsBase.find(g=>g.value===u);return s?p(s.labelKey):u},getSubjectLabel(u,e){const p=e||(g=>g),s=this.subjectOptionsBase.find(g=>g.value===u);return s?p(s.labelKey):u},async fetchContacts({page:u=1,itemsPerPage:e=15,status:p="",subject:s=""}){this.loading=!0;try{const g={page:u,perPage:e,search:this.contactSearch,status:p,subject:s},h=await $.get("contacts",{params:g});h.data.success?(this.contacts=h.data.data,this.totalItems=h.data.meta.total):m.error("Failed to fetch contacts")}catch(g){console.error("Error fetching contacts:",g),m.error("Error fetching contacts")}finally{this.loading=!1}},async getContact(u){this.loading=!0;try{const e=await $.get(`contacts/${u}`);if(e.data.success)return this.currentContact=e.data.data,e.data.data;m.error("Failed to fetch contact")}catch(e){console.error("Error fetching contact:",e),m.error("Error fetching contact")}finally{this.loading=!1}},async updateContactStatus(u,e){try{const p=await $.patch(`contacts/${u}`,{status:e});if(p.data.success)return m.success("Contact updated successfully"),this.fetchContacts({page:1,itemsPerPage:this.itemsPerPage}),p.data.data;m.error("Failed to update contact")}catch(p){console.error("Error updating contact:",p),p.response?.data?.message?m.error(p.response.data.message):m.error("Error updating contact")}},async markAsRead(u){try{const e=await $.patch(`contacts/${u}/mark-as-read`);if(e.data.success)return m.success("Contact marked as read"),this.fetchContacts({page:1,itemsPerPage:this.itemsPerPage}),e.data.data;m.error("Failed to mark contact as read")}catch(e){console.error("Error marking contact as read:",e),m.error("Error marking contact as read")}},async markAsReplied(u){try{const e=await $.patch(`contacts/${u}/mark-as-replied`);if(e.data.success)return m.success("Contact marked as replied"),this.fetchContacts({page:1,itemsPerPage:this.itemsPerPage}),e.data.data;m.error("Failed to mark contact as replied")}catch(e){console.error("Error marking contact as replied:",e),m.error("Error marking contact as replied")}},async deleteContact(u){try{(await $.delete(`contacts/${u}`)).data.success?(m.success("Contact deleted successfully"),this.fetchContacts({page:1,itemsPerPage:this.itemsPerPage})):m.error("Failed to delete contact")}catch(e){console.error("Error deleting contact:",e),e.response?.data?.message?m.error(e.response.data.message):m.error("Error deleting contact")}},async bulkDeleteContacts(u){try{const e=u.map(p=>$.delete(`contacts/${p}`));await Promise.all(e),m.success(`${u.length} contact(s) deleted successfully`),this.fetchContacts({page:1,itemsPerPage:this.itemsPerPage})}catch(e){console.error("Error bulk deleting contacts:",e),m.error("Error deleting contacts")}},resetCurrentContact(){this.currentContact={}}}});const Pe=["dir"],xe={class:"btn-search pt-12 pb-6"},$e={class:"text-field w-25"},we={class:"flex gap-2"},je={class:"table-section"},Se={class:"py-2 pl-4 d-flex align-center"},Ve={class:"font-weight-medium"},Ke={class:"text-caption text-grey"},Ee={class:"py-2 pl-4"},Be={class:"py-2 pl-4"},Re={class:"py-2 pl-4"},Fe={class:"text-caption text-truncate",style:{"max-width":"300px"}},Ie={class:"py-2 pl-4"},Oe={class:"text-caption"},Te={class:"space-y-4"},Ue={class:"text-sm font-medium text-grey-darken-1"},Ae={class:"text-body-1"},De={class:"text-sm font-medium text-grey-darken-1"},Le={class:"text-body-1"},qe=["href"],ze={key:0},Ne={class:"text-sm font-medium text-grey-darken-1"},He={class:"text-body-1"},Ge=["href"],Me={class:"text-sm font-medium text-grey-darken-1"},Je={class:"text-body-1"},Qe={key:1},We={class:"text-sm font-medium text-grey-darken-1"},Xe={class:"text-body-1"},Ye={class:"text-sm font-medium text-grey-darken-1"},Ze={class:"text-body-1"},et={key:2},tt={class:"text-sm font-medium text-grey-darken-1"},at={class:"text-body-1"},st={key:3},lt={class:"text-sm font-medium text-grey-darken-1"},ot={class:"text-body-1"},nt=["href"],rt={class:"text-sm font-medium text-grey-darken-1"},ct={class:"text-body-1"},it={class:"text-sm font-medium text-grey-darken-1"},dt={class:"text-body-1"},ut={__name:"Contacts",setup(u){const{t:e,locale:p}=be();ke();const s=Ce(),g=B(()=>["fa","ps"].includes(p.value)?"rtl":"ltr"),h=f(""),P=f(""),k=f(!1),c=f(null),L=B(()=>s.statusOptionsBase.map(t=>({value:t.value,label:e(t.labelKey)}))),q=B(()=>s.subjectOptionsBase.map(t=>({value:t.value,label:e(t.labelKey)})));ge(()=>{s.fetchContacts({page:1,itemsPerPage:s.itemsPerPage,status:h.value,type:P.value})});let F;const z=()=>{clearTimeout(F),F=setTimeout(()=>{s.fetchContacts({page:1,itemsPerPage:s.itemsPerPage,status:h.value,subject:P.value})},500)},N=()=>{s.fetchContacts({page:1,itemsPerPage:s.itemsPerPage,status:h.value,type:P.value})},H=()=>{s.fetchContacts({page:1,itemsPerPage:s.itemsPerPage,status:h.value,type:P.value})},G=t=>{s.fetchContacts({page:t.page,itemsPerPage:t.itemsPerPage,status:h.value,type:P.value})},C=f([]),M=()=>{C.value.length>0&&confirm(e("confirm_delete_contacts",{count:C.value.length}))&&(s.bulkDeleteContacts(C.value),C.value=[])},J=async t=>{await s.getContact(t.id),c.value=s.currentContact,k.value=!0},I=async t=>{await s.markAsRead(t.id),k.value&&c.value?.id===t.id&&(c.value.status="read")},O=async t=>{await s.markAsReplied(t.id),k.value&&c.value?.id===t.id&&(c.value.status="replied")},Q=async t=>{confirm(e("confirm_delete_contact"))&&(await s.deleteContact(t.id),k.value&&c.value?.id===t.id&&(k.value=!1,c.value=null))},T=t=>{switch(t){case"new":return"error";case"read":return"warning";case"replied":return"success";case"archived":return"grey";default:return"primary"}},U=t=>new Date(t).toLocaleDateString(),W=B(()=>[{title:"",key:"checkbox",align:"start",sortable:!1},{title:e("name"),key:"name",align:"start",sortable:!1},{title:e("subject"),key:"subject",align:"start",sortable:!1},{title:e("status"),key:"status",align:"start",sortable:!1},{title:e("message"),key:"message",align:"start",sortable:!1},{title:e("created_at"),key:"created_at",align:"start",sortable:!1},{title:e("action"),key:"action",align:"end",sortable:!1}]);return(t,i)=>{const R=d("v-divider"),X=d("v-text-field"),A=d("v-select"),V=d("v-chip"),Y=d("v-checkbox"),w=d("v-btn"),K=d("v-icon"),E=d("v-list-item-title"),Z=d("v-list-item"),ee=d("v-list"),te=d("v-menu"),ae=d("v-data-table-server"),se=d("v-col"),le=d("v-row"),oe=d("v-main"),ne=d("v-app"),re=d("v-card-title"),ce=d("v-card-text"),ie=d("v-spacer"),de=d("v-card-actions"),ue=d("v-card"),me=d("v-dialog");return y(),S(he,null,[a("div",{dir:g.value},[r(ye,{pageTitle:t.$t("contacts_management")},null,8,["pageTitle"]),r(R,{thickness:1,class:"border-opacity-100"}),a("div",xe,[a("div",$e,[r(X,{color:"primary",density:"compact",variant:"outlined",label:t.$t("search"),"append-inner-icon":"mdi-magnify","hide-details":"",modelValue:v(s).contactSearch,"onUpdate:modelValue":i[0]||(i[0]=l=>v(s).contactSearch=l),onInput:z},null,8,["label","modelValue"])]),a("div",we,[r(A,{modelValue:h.value,"onUpdate:modelValue":[i[1]||(i[1]=l=>h.value=l),N],items:L.value,variant:"outlined",density:"compact","item-value":"value","item-title":"label",label:t.$t("status"),class:"text-field"},null,8,["modelValue","items","label"]),r(A,{modelValue:P.value,"onUpdate:modelValue":[i[2]||(i[2]=l=>P.value=l),H],items:q.value,variant:"outlined",density:"compact","item-value":"value","item-title":"label",label:t.$t("subject"),class:"text-field"},null,8,["modelValue","items","label"])])]),a("div",je,[r(ne,null,{default:o(()=>[r(oe,{class:"main"},{default:o(()=>[r(le,null,{default:o(()=>[r(se,null,{default:o(()=>[r(ae,{dir:g.value,theme:"cursor-pointer","items-per-page":v(s).itemsPerPage,"onUpdate:itemsPerPage":i[4]||(i[4]=l=>v(s).itemsPerPage=l),headers:W.value,"items-length":v(s).totalItems,items:v(s).contacts,loading:v(s).loading,"onUpdate:options":G,hover:"",class:"w-100 mx-auto"},{"item.name":o(({item:l})=>[a("div",Se,[a("div",null,[a("div",Ve,n(l.name),1),a("div",Ke,n(l.email),1)])])]),"item.subject":o(({item:l})=>[a("div",Ee,[r(V,{size:"small",variant:"outlined",color:"primary"},{default:o(()=>[_(n(v(s).getSubjectLabel(l.subject,v(e))),1)]),_:2},1024)])]),"item.status":o(({item:l})=>[a("div",Be,[r(V,{color:T(l.status),size:"small",variant:"flat"},{default:o(()=>[_(n(v(s).getStatusLabel(l.status,v(e))),1)]),_:2},1032,["color"])])]),"item.message":o(({item:l})=>[a("div",Re,[a("div",Fe,n(l.message?.substring(0,80))+n(l.message?.length>80?"...":""),1)])]),"item.created_at":o(({item:l})=>[a("div",Ie,[a("div",Oe,n(U(l.created_at)),1)])]),"item.checkbox":o(({item:l})=>[r(Y,{value:l.id,modelValue:C.value,"onUpdate:modelValue":i[3]||(i[3]=x=>C.value=x),class:"w-6 d-flex"},null,8,["value","modelValue"])]),"item.action":o(({item:l})=>[r(te,null,{activator:o(({props:x})=>[r(w,fe({icon:"mdi-dots-vertical"},x,{variant:"text"}),null,16)]),default:o(()=>[r(ee,null,{default:o(()=>[r(Z,null,{default:o(()=>[r(E,{onClick:x=>J(l),class:"cursor-pointer d-flex gap-3 justify-left pb-3"},{default:o(()=>[r(K,{color:"primary"},{default:o(()=>[...i[10]||(i[10]=[_("mdi-eye",-1)])]),_:1}),_(" "+n(t.$t("view")),1)]),_:1},8,["onClick"]),l.status==="new"?(y(),j(E,{key:0,onClick:x=>I(l),class:"cursor-pointer d-flex gap-3 pb-3"},{default:o(()=>[r(K,{color:"info"},{default:o(()=>[...i[11]||(i[11]=[_("mdi-email-mark-as-unread",-1)])]),_:1}),_(" "+n(t.$t("mark_as_read")),1)]),_:1},8,["onClick"])):b("",!0),l.status!=="replied"?(y(),j(E,{key:1,onClick:x=>O(l),class:"cursor-pointer d-flex gap-3 pb-3"},{default:o(()=>[r(K,{color:"success"},{default:o(()=>[...i[12]||(i[12]=[_("mdi-reply",-1)])]),_:1}),_(" "+n(t.$t("mark_as_replied")),1)]),_:1},8,["onClick"])):b("",!0),r(E,{class:"cursor-pointer d-flex gap-3",onClick:x=>Q(l)},{default:o(()=>[r(K,{color:"error"},{default:o(()=>[...i[13]||(i[13]=[_("mdi-delete-outline",-1)])]),_:1}),_(" "+n(t.$t("delete")),1)]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1},8,["dir","items-per-page","headers","items-length","items","loading"]),C.value.length>0?(y(),j(w,{key:0,class:"header-button",onClick:M,color:"#B71C1C",flat:"",inset:"",text:v(e)("delete_selected",{count:C.value.length})},null,8,["text"])):b("",!0)]),_:1})]),_:1})]),_:1})]),_:1})])],8,Pe),r(me,{modelValue:k.value,"onUpdate:modelValue":i[9]||(i[9]=l=>k.value=l),"max-width":"800",persistent:""},{default:o(()=>[c.value?(y(),j(ue,{key:0},{default:o(()=>[r(re,{class:"d-flex justify-space-between align-center"},{default:o(()=>[a("span",null,n(t.$t("contact_details")),1),r(w,{icon:"mdi-close",variant:"text",onClick:i[5]||(i[5]=l=>k.value=!1)})]),_:1}),r(R),r(ce,{class:"pt-6"},{default:o(()=>[a("div",Te,[a("div",null,[a("label",Ue,n(t.$t("name")),1),a("p",Ae,n(c.value.name),1)]),a("div",null,[a("label",De,n(t.$t("email")),1),a("p",Le,[a("a",{href:`mailto:${c.value.email}`,class:"text-primary"},n(c.value.email),9,qe)])]),c.value.phone?(y(),S("div",ze,[a("label",Ne,n(t.$t("phone")),1),a("p",He,[a("a",{href:`tel:${c.value.phone}`,class:"text-primary"},n(c.value.phone),9,Ge)])])):b("",!0),a("div",null,[a("label",Me,n(t.$t("subject")),1),a("p",Je,[r(V,{size:"small",variant:"outlined",color:"primary"},{default:o(()=>[_(n(v(s).getSubjectLabel(c.value.subject,v(e))),1)]),_:1})])]),c.value.job_title?(y(),S("div",Qe,[a("label",We,n(t.$t("job_title")),1),a("p",Xe,n(c.value.job_title),1)])):b("",!0),a("div",null,[a("label",Ye,n(t.$t("message")),1),a("p",Ze,n(c.value.message),1)]),c.value.cover_letter?(y(),S("div",et,[a("label",tt,n(t.$t("cover_letter")),1),a("p",at,n(c.value.cover_letter),1)])):b("",!0),c.value.cv_file_path?(y(),S("div",st,[a("label",lt,n(t.$t("cv_resume")),1),a("p",ot,[a("a",{href:`/storage/${c.value.cv_file_path}`,target:"_blank",class:"text-primary"},n(t.$t("download_cv")),9,nt)])])):b("",!0),a("div",null,[a("label",rt,n(t.$t("status")),1),a("p",ct,[r(V,{color:T(c.value.status),size:"small",variant:"flat"},{default:o(()=>[_(n(v(s).getStatusLabel(c.value.status,v(e))),1)]),_:1},8,["color"])])]),a("div",null,[a("label",it,n(t.$t("submitted_at")),1),a("p",dt,n(U(c.value.created_at)),1)])])]),_:1}),r(R),r(de,null,{default:o(()=>[r(ie),c.value.status==="new"?(y(),j(w,{key:0,onClick:i[6]||(i[6]=l=>I(c.value)),color:"info"},{default:o(()=>[_(n(t.$t("mark_as_read")),1)]),_:1})):b("",!0),c.value.status!=="replied"?(y(),j(w,{key:1,onClick:i[7]||(i[7]=l=>O(c.value)),color:"success"},{default:o(()=>[_(n(t.$t("mark_as_replied")),1)]),_:1})):b("",!0),r(w,{onClick:i[8]||(i[8]=l=>k.value=!1),variant:"outlined"},{default:o(()=>[_(n(t.$t("close")),1)]),_:1})]),_:1})]),_:1})):b("",!0)]),_:1},8,["modelValue"])],64)}}},ft=_e(ut,[["__scopeId","data-v-b62424d9"]]);export{ft as default};
