import{ak as le,j as C,M as J,r as v,am as ne,s as G,c as D,z as N,h as f,A as z,k as x,w as m,g as a,d as b,u as h,b as L,f as Y,m as y,t as _,v as oe,$ as re,F as ie}from"./_plugin-vue_export-helper-Bve7U4QZ.js";import{H as de}from"./Header-EurA_yJ3.js";import{l as c,u as K,a as ue}from"./admin-DEzJhurF.js";import{T as j,a as ce}from"./TranslationField-BohEiJDC.js";/* empty css                                                               *//* empty css              */let H=le("JobAnnouncementRepository",{state(){return{isEditMode:v(!1),router:ne(),search:v(""),loadingTable:v(!0),loading:v(!0),totalItems:v(0),selectedItems:v([]),itemsPerPage:v(5),createDialog:v(!1),jobs:J([]),jobSearch:v(""),currentJob:J({}),statusOptions:J([{value:"draft",label:"Draft"},{value:"open",label:"Open"},{value:"closed",label:"Closed"},{value:"archived",label:"Archived"}])}},actions:{setEditMode(i){this.isEditMode=i},getTodaysDate(){const i=new Date,t=i.getFullYear(),d=String(i.getMonth()+1).padStart(2,"0"),r=String(i.getDate()).padStart(2,"0");return`${t}-${d}-${r}`},async fetchJobs({page:i=1,itemsPerPage:t=5,status:d=""}){this.loading=!0;try{const r={page:i,perPage:t,search:this.jobSearch,status:d},$=await C.get("job-announcements",{params:r});$.data.success?(this.jobs=$.data.data,this.totalItems=$.data.meta.total):c.error("Failed to fetch job announcements")}catch(r){console.error("Error fetching job announcements:",r),c.error("Error fetching job announcements")}finally{this.loading=!1}},async createJob(i){try{const t=await C.post("job-announcements",i);if(t.data.success)return c.success("Job announcement created successfully"),this.createDialog=!1,this.resetCurrentJob(),this.fetchJobs({page:1,itemsPerPage:this.itemsPerPage}),t.data.data;c.error("Failed to create job announcement")}catch(t){console.error("Error creating job announcement:",t),t.response?.data?.message?c.error(t.response.data.message):c.error("Error creating job announcement")}},async updateJob(i,t){try{const d=await C.put(`/api/admin/job-announcements/${i}`,t);if(d.data.success)return c.success("Job announcement updated successfully"),this.createDialog=!1,this.resetCurrentJob(),this.fetchJobs({page:1,itemsPerPage:this.itemsPerPage}),d.data.data;c.error("Failed to update job announcement")}catch(d){console.error("Error updating job announcement:",d),d.response?.data?.message?c.error(d.response.data.message):c.error("Error updating job announcement")}},async deleteJob(i){try{(await C.delete(`/api/admin/job-announcements/${i}`)).data.success?(c.success("Job announcement deleted successfully"),this.fetchJobs({page:1,itemsPerPage:this.itemsPerPage})):c.error("Failed to delete job announcement")}catch(t){console.error("Error deleting job announcement:",t),t.response?.data?.message?c.error(t.response.data.message):c.error("Error deleting job announcement")}},async bulkDeleteJobs(i){try{(await C.post("/api/admin/job-announcements/bulk-delete",{ids:i})).data.success?(c.success(`${i.length} job announcements deleted successfully`),this.fetchJobs({page:1,itemsPerPage:this.itemsPerPage})):c.error("Failed to delete job announcements")}catch(t){console.error("Error bulk deleting job announcements:",t),t.response?.data?.message?c.error(t.response.data.message):c.error("Error deleting job announcements")}},async toggleStatus(i){try{(await C.patch(`/api/admin/job-announcements/${i}/toggle-status`)).data.success?(c.success("Job announcement status updated successfully"),this.fetchJobs({page:1,itemsPerPage:this.itemsPerPage})):c.error("Failed to update job announcement status")}catch(t){console.error("Error toggling job announcement status:",t),t.response?.data?.message?c.error(t.response.data.message):c.error("Error updating job announcement status")}},async getJob(i){try{const t=await C.get(`/api/admin/job-announcements/${i}`);if(t.data.success)return t.data.data;c.error("Failed to fetch job announcement")}catch(t){console.error("Error fetching job announcement:",t),t.response?.data?.message?c.error(t.response.data.message):c.error("Error fetching job announcement")}},resetCurrentJob(){this.currentJob={title:"",slug:"",description:"",requirements:"",location:"",salary_range:"",deadline:this.getTodaysDate(),status:"draft",farsi_translations:{title:"",location:"",description:"",requirements:""},pashto_translations:{title:"",location:"",description:"",requirements:""}}},getStatusLabel(i){const t=this.statusOptions.find(d=>d.value===i);return t?t.label:i},getStatusColor(i){return{draft:"warning",open:"success",closed:"error",archived:"grey"}[i]||"primary"}}});H();const me={class:"flex w-100"},pe={class:"flex w-100"},ge={class:"flex w-100"},fe={class:"flex w-100"},be={class:"flex w-100"},he={__name:"CreateJobAnnouncement",setup(i){const{t}=K(),d=H(),r=D(()=>d.isEditMode?t("edit_job_announcement"):t("create_job_announcement")),$=D(()=>d.isEditMode?t("update"):t("create")),k=v(!1),F=["title","location","description","requirements"],l=J({id:null,title:"",slug:"",description:"",requirements:"",location:"",salary_range:"",deadline:"",status:"draft",farsi_translations:{},pashto_translations:{}}),u=J({title:"",location:"",description:"",requirements:""}),o=J({title:"",location:"",description:"",requirements:""});N(()=>d.currentJob,e=>{e&&Object.keys(e).length>0&&(l.id=e.id||null,l.title=e.title||"",l.slug=e.slug||"",l.description=e.description||"",l.requirements=e.requirements||"",l.location=e.location||"",l.salary_range=e.salary_range||"",l.deadline=e.deadline||"",l.status=e.status||"draft",l.farsi_translations=e.farsi_translations||{},l.pashto_translations=e.pashto_translations||{},u.title=e.farsi_translations?.title||"",u.location=e.farsi_translations?.location||"",u.description=e.farsi_translations?.description||"",u.requirements=e.farsi_translations?.requirements||"",o.title=e.pashto_translations?.title||"",o.location=e.pashto_translations?.location||"",o.description=e.pashto_translations?.description||"",o.requirements=e.pashto_translations?.requirements||"")}),N(()=>d.createDialog,e=>{e||M()});const M=()=>{l.id=null,l.title="",l.slug="",l.description="",l.requirements="",l.location="",l.salary_range="",l.deadline="",l.status="draft",l.farsi_translations={},l.pashto_translations={},u.title="",u.location="",u.description="",u.requirements="",o.title="",o.location="",o.description="",o.requirements=""},A=()=>{l.title&&!l.slug&&(l.slug=l.title.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim("-"))},U=e=>u[e]&&u[e].trim()!=="",w=e=>o[e]&&o[e].trim()!=="",E=e=>{u[e]=""},S=e=>{o[e]=""},I=async()=>{k.value=!0;try{const e={title:u.title,location:u.location,description:u.description,requirements:u.requirements},n={title:o.title,location:o.location,description:o.description,requirements:o.requirements};l.farsi_translations=e,l.pashto_translations=n,d.isEditMode?await d.updateJob(l.id,l):await d.createJob(l)}catch(e){console.error("Error saving job announcement:",e)}finally{k.value=!1}},R={required:e=>!!e||t("field_required")};return(e,n)=>{const q=f("v-text-field"),O=f("v-select"),P=f("v-textarea");return x(),z(ce,{modelValue:h(d).createDialog,"onUpdate:modelValue":n[8]||(n[8]=p=>h(d).createDialog=p),"form-title":r.value,"button-text":$.value,"translatable-fields":F,"form-data":l,rules:R,saving:k.value,"is-edit-mode":h(d).isEditMode,onSave:I},{"base-fields":m(({formData:p,rules:V})=>[b("div",me,[a(q,{modelValue:p.title,"onUpdate:modelValue":s=>p.title=s,variant:"outlined",label:e.$t("title"),density:"compact",class:"pb-4 pr-2 w-75",rules:[V.required],onInput:A},null,8,["modelValue","onUpdate:modelValue","label","rules"]),a(O,{modelValue:p.status,"onUpdate:modelValue":s=>p.status=s,items:h(d).statusOptions,variant:"outlined",density:"compact","item-value":"value","item-title":"label","return-object":!1,label:e.$t("status"),class:"pb-4 pl-2 w-25",rules:[V.required]},null,8,["modelValue","onUpdate:modelValue","items","label","rules"])]),b("div",pe,[a(q,{modelValue:p.slug,"onUpdate:modelValue":s=>p.slug=s,variant:"outlined",label:e.$t("slug"),density:"compact",class:"pb-4 pr-2 w-50",hint:"URL-friendly version of the title"},null,8,["modelValue","onUpdate:modelValue","label"]),a(q,{modelValue:p.location,"onUpdate:modelValue":s=>p.location=s,variant:"outlined",label:e.$t("location"),density:"compact",class:"pb-4 pl-2 w-50",rules:[V.required]},null,8,["modelValue","onUpdate:modelValue","label","rules"])]),b("div",ge,[a(P,{modelValue:p.description,"onUpdate:modelValue":s=>p.description=s,variant:"outlined",label:e.$t("description"),density:"compact",class:"pb-4 w-100",rules:[V.required],rows:"4"},null,8,["modelValue","onUpdate:modelValue","label","rules"])]),b("div",fe,[a(P,{modelValue:p.requirements,"onUpdate:modelValue":s=>p.requirements=s,variant:"outlined",label:e.$t("requirements"),density:"compact",class:"pb-4 w-100",rows:"3"},null,8,["modelValue","onUpdate:modelValue","label"])]),b("div",be,[a(q,{modelValue:p.salary_range,"onUpdate:modelValue":s=>p.salary_range=s,variant:"outlined",label:e.$t("salary_range"),density:"compact",class:"pb-4 pr-2 w-50"},null,8,["modelValue","onUpdate:modelValue","label"]),a(q,{modelValue:p.deadline,"onUpdate:modelValue":s=>p.deadline=s,variant:"outlined",label:e.$t("application_deadline"),density:"compact",class:"pb-4 pl-2 w-50",type:"date",rules:[V.required]},null,8,["modelValue","onUpdate:modelValue","label","rules"])])]),"farsi-fields":m(({formData:p,rules:V})=>[a(j,{modelValue:u.title,"onUpdate:modelValue":n[0]||(n[0]=s=>u.title=s),"field-name":"title","field-label":e.$t("title"),language:"farsi","language-label":e.$t("farsi"),"has-translation":U("title"),onClear:E},null,8,["modelValue","field-label","language-label","has-translation"]),a(j,{modelValue:u.location,"onUpdate:modelValue":n[1]||(n[1]=s=>u.location=s),"field-name":"location","field-label":e.$t("location"),language:"farsi","language-label":e.$t("farsi"),"has-translation":U("location"),onClear:E},null,8,["modelValue","field-label","language-label","has-translation"]),a(j,{modelValue:u.description,"onUpdate:modelValue":n[2]||(n[2]=s=>u.description=s),"field-name":"description","field-label":e.$t("description"),language:"farsi","language-label":e.$t("farsi"),"field-type":"textarea",rows:4,"has-translation":U("description"),onClear:E},null,8,["modelValue","field-label","language-label","has-translation"]),a(j,{modelValue:u.requirements,"onUpdate:modelValue":n[3]||(n[3]=s=>u.requirements=s),"field-name":"requirements","field-label":e.$t("requirements"),language:"farsi","language-label":e.$t("farsi"),"field-type":"textarea",rows:3,"has-translation":U("requirements"),onClear:E},null,8,["modelValue","field-label","language-label","has-translation"])]),"pashto-fields":m(({formData:p,rules:V})=>[a(j,{modelValue:o.title,"onUpdate:modelValue":n[4]||(n[4]=s=>o.title=s),"field-name":"title","field-label":e.$t("title"),language:"pashto","language-label":e.$t("pashto"),"has-translation":w("title"),onClear:S},null,8,["modelValue","field-label","language-label","has-translation"]),a(j,{modelValue:o.location,"onUpdate:modelValue":n[5]||(n[5]=s=>o.location=s),"field-name":"location","field-label":e.$t("location"),language:"pashto","language-label":e.$t("pashto"),"has-translation":w("location"),onClear:S},null,8,["modelValue","field-label","language-label","has-translation"]),a(j,{modelValue:o.description,"onUpdate:modelValue":n[6]||(n[6]=s=>o.description=s),"field-name":"description","field-label":e.$t("description"),language:"pashto","language-label":e.$t("pashto"),"field-type":"textarea",rows:4,"has-translation":w("description"),onClear:S},null,8,["modelValue","field-label","language-label","has-translation"]),a(j,{modelValue:o.requirements,"onUpdate:modelValue":n[7]||(n[7]=s=>o.requirements=s),"field-name":"requirements","field-label":e.$t("requirements"),language:"pashto","language-label":e.$t("pashto"),"field-type":"textarea",rows:3,"has-translation":w("requirements"),onClear:S},null,8,["modelValue","field-label","language-label","has-translation"])]),_:1},8,["modelValue","form-title","button-text","form-data","saving","is-edit-mode"])}}},ve=G(he,[["__scopeId","data-v-17d62543"]]),_e=["dir"],ye={class:"btn-search pt-12 pb-6"},Ve={class:"text-field w-25"},$e={class:"flex"},je={class:"table-section"},qe={class:"py-2 pl-4 d-flex align-center"},Pe={class:"font-weight-medium"},Ce={class:"text-caption text-grey"},ke={class:"py-2 pl-4"},Ue={class:"py-2 pl-4"},we={class:"text-caption"},Ee={key:0,class:"text-caption text-success"},Se={key:1,class:"text-caption text-error"},Te={__name:"JobAnnouncements",setup(i){const{t,locale:d}=K();ue();const r=H(),$=D(()=>["fa","ps"].includes(d.value)?"rtl":"ltr"),k=v("");let F;const l=()=>{clearTimeout(F),F=setTimeout(()=>{r.fetchJobs({page:1,itemsPerPage:r.itemsPerPage,status:k.value})},500)},u=e=>{r.fetchJobs({page:e.page,itemsPerPage:e.itemsPerPage,status:k.value})},o=v([]),M=()=>{o.value.length>0&&(r.bulkDeleteJobs(o.value),o.value=[])},A=()=>{r.resetCurrentJob(),r.isEditMode=!1,r.createDialog=!0},U=e=>{r.isEditMode=!0,r.currentJob={...e},r.createDialog=!0},w=async e=>{await r.deleteJob(e.id)},E=async e=>{await r.toggleStatus(e.id)},S=e=>{switch(e){case"open":return"success";case"draft":return"warning";case"closed":return"error";case"archived":return"grey";default:return"primary"}},I=e=>new Date(e).toLocaleDateString(),R=D(()=>[{title:"",key:"checkbox",align:"start",sortable:!1},{title:t("title"),key:"title",align:"start",sortable:!0},{title:t("status"),key:"status",align:"center",sortable:!0},{title:t("deadline"),key:"deadline",align:"center",sortable:!0},{title:t("created_date"),key:"created_at",align:"center",sortable:!0},{title:t("action"),key:"action",align:"center",sortable:!1}]);return(e,n)=>{const q=f("v-divider"),O=f("v-text-field"),P=f("v-btn"),p=f("v-chip"),V=f("v-checkbox"),s=f("v-icon"),B=f("v-list-item-title"),Q=f("v-list-item"),W=f("v-list"),X=f("v-menu"),Z=f("v-data-table-server"),ee=f("v-col"),te=f("v-row"),ae=f("v-main"),se=f("v-app");return x(),L(ie,null,[h(r).createDialog?(x(),z(ve,{key:0})):Y("",!0),b("div",{dir:$.value},[a(de,{pageTitle:e.$t("job_announcements")},null,8,["pageTitle"]),a(q,{thickness:1,class:"border-opacity-100"}),b("div",ye,[b("div",Ve,[a(O,{color:"primary",density:"compact",variant:"outlined",label:e.$t("search"),"append-inner-icon":"mdi-magnify","hide-details":"",modelValue:h(r).jobSearch,"onUpdate:modelValue":n[0]||(n[0]=g=>h(r).jobSearch=g),onInput:l},null,8,["label","modelValue"])]),b("div",$e,[a(P,{class:"action-btn-success"},{default:m(()=>[y(_(h(t)("filter")),1)]),_:1}),n[3]||(n[3]=y(" Â  ",-1)),a(P,{onClick:oe(A,["stop"]),variant:"flat",class:"action-btn-success"},{default:m(()=>[y(_(h(t)("create")),1)]),_:1})])]),b("div",je,[a(se,null,{default:m(()=>[a(ae,{class:"main"},{default:m(()=>[a(te,null,{default:m(()=>[a(ee,null,{default:m(()=>[a(Z,{dir:$.value,theme:"cursor-pointer","items-per-page":h(r).itemsPerPage,"onUpdate:itemsPerPage":n[2]||(n[2]=g=>h(r).itemsPerPage=g),headers:R.value,"items-length":h(r).totalItems,items:h(r).jobs,loading:h(r).loading,"onUpdate:options":u,hover:"",class:"w-100 mx-auto"},{"item.title":m(({item:g})=>[b("div",qe,[b("div",null,[b("div",Pe,_(g.title),1),b("div",Ce,_(g.location),1)])])]),"item.status":m(({item:g})=>[b("div",ke,[a(p,{color:S(g.status),size:"small",variant:"flat"},{default:m(()=>[y(_(h(r).getStatusLabel(g.status)),1)]),_:2},1032,["color"])])]),"item.deadline":m(({item:g})=>[b("div",Ue,[b("div",we,_(I(g.deadline)),1),g.days_remaining>0?(x(),L("div",Ee,_(g.days_remaining)+" days left ",1)):(x(),L("div",Se," Expired "))])]),"item.checkbox":m(({item:g})=>[a(V,{value:g.id,modelValue:o.value,"onUpdate:modelValue":n[1]||(n[1]=T=>o.value=T),class:"w-6 d-flex"},null,8,["value","modelValue"])]),"item.action":m(({item:g})=>[a(X,null,{activator:m(({props:T})=>[a(P,re({icon:"mdi-dots-vertical"},T,{variant:"text"}),null,16)]),default:m(()=>[a(W,null,{default:m(()=>[a(Q,null,{default:m(()=>[a(B,{onClick:T=>U(g),class:"cursor-pointer d-flex gap-3 justify-left pb-3"},{default:m(()=>[a(s,{color:"tealColor"},{default:m(()=>[...n[4]||(n[4]=[y("mdi-square-edit-outline",-1)])]),_:1}),y(" "+_(e.$t("edit")),1)]),_:1},8,["onClick"]),a(B,{onClick:T=>E(g),class:"cursor-pointer d-flex gap-3 pb-3"},{default:m(()=>[a(s,{color:g.status==="open"?"orange":"green"},{default:m(()=>[y(_(g.status==="open"?"mdi-eye-off":"mdi-eye"),1)]),_:2},1032,["color"]),y(" "+_(g.status==="open"?"Close":"Open"),1)]),_:2},1032,["onClick"]),a(B,{class:"cursor-pointer d-flex gap-3",onClick:T=>w(g)},{default:m(()=>[a(s,{color:"error"},{default:m(()=>[...n[5]||(n[5]=[y("mdi-delete-outline",-1)])]),_:1}),y(" "+_(e.$t("delete")),1)]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1},8,["dir","items-per-page","headers","items-length","items","loading"]),o.value.length>0?(x(),z(P,{key:0,class:"header-button",onClick:M,color:"#B71C1C",flat:"",inset:"",text:`Delete ${o.value.length} selected`},null,8,["text"])):Y("",!0)]),_:1})]),_:1})]),_:1})]),_:1})])],8,_e)],64)}}},Ie=G(Te,[["__scopeId","data-v-d170dde2"]]);export{Ie as default};
