import{al as fe,i as F,N as K,r as f,G as he,q as ce,c as H,y as re,h,z as te,j as y,w as n,g as l,d as s,u as V,t as P,B as me,D as ge,b as w,f as E,s as x,l as b,o as be,a0 as ye,F as pe,e as Ce}from"./_plugin-vue_export-helper-P6s7mfAX.js";import{H as Pe}from"./Header-Dc2gjrUc.js";import{l as S,u as ve,a as Ve}from"./admin-C1tUPR0Q.js";import{T as J,a as $e}from"./TranslationField-DYZ6aUjw.js";/* empty css                                                               *//* empty css              */let _e=fe("CommunityProgramsRepository",{state(){return{isEditMode:f(!1),router:he(),search:f(""),loadingTable:f(!0),loading:f(!0),totalItems:f(0),selectedItems:f([]),itemsPerPage:f(5),createDialog:f(!1),communityPrograms:K([]),communityProgramsSearch:f(""),currentCommunityProgram:K({}),statusOptions:K([{value:"draft",label:"Draft"},{value:"published",label:"Published"},{value:"ongoing",label:"Ongoing"},{value:"completed",label:"Completed"},{value:"cancelled",label:"Cancelled"}]),programTypeOptions:K([{value:"education",label:"Education"},{value:"health",label:"Health"},{value:"livelihood",label:"Livelihood"},{value:"women_empowerment",label:"Women Empowerment"},{value:"youth_development",label:"Youth Development"},{value:"social_welfare",label:"Social Welfare"}]),targetGroupOptions:K([{value:"women",label:"Women"},{value:"youth",label:"Youth"},{value:"children",label:"Children"},{value:"elderly",label:"Elderly"},{value:"farmers",label:"Farmers"},{value:"general_community",label:"General Community"}])}},actions:{setEditMode(p){this.isEditMode=p},getTodaysDate(){const p=new Date,r=p.getFullYear(),i=String(p.getMonth()+1).padStart(2,"0"),u=String(p.getDate()).padStart(2,"0");return`${r}-${i}-${u}`},async fetchCommunityPrograms({page:p=1,itemsPerPage:r=5,status:i=""}){this.loading=!0;try{const u=new URLSearchParams({page:p,perPage:r,search:this.communityProgramsSearch});i&&u.append("status",i);const j=await F.get(`community-programs?${u}`);j.data.success?(this.communityPrograms=j.data.data||[],this.totalItems=j.data.meta?.total||0):(this.communityPrograms=[],this.totalItems=0,S.error(j.data.message||"Failed to fetch data",{position:"top-right",autoClose:3e3})),this.loading=!1}catch(u){this.communityPrograms=[],this.totalItems=0,this.loading=!1;const j=u.response?.data?.message||"Failed to fetch community programs";S.error(j,{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}},async fetchCommunityProgram(p){this.loading=!0;try{const r=await F.get(`community-programs/${p}`,{params:{include_translations:1}});this.currentCommunityProgram=r.data.data,this.loading=!1}catch{this.loading=!1,S.error("Failed to fetch community program",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}},async createCommunityProgram(p){try{const r=await F.post("community-programs",p);this.createDialog=!1,S.success("Community program created successfully!",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}),this.fetchCommunityPrograms({page:1,itemsPerPage:this.itemsPerPage})}catch(r){const i=r.response?.data?.message||"Failed to create community program. Please try again.";S.error(i,{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}},async updateCommunityProgram(p,r){try{const i=await F.post(`community-programs/${p}`,r,{headers:{_method:"PUT"}});return this.createDialog=!1,this.isEditMode=!1,S.success("Community program updated successfully!",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}),this.fetchCommunityPrograms({page:1,itemsPerPage:this.itemsPerPage}),i}catch(i){const u=i.response?.data?.message||"Failed to update community program. Please try again.";throw S.error(u,{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}),i}},async deleteCommunityProgram(p){try{await F.delete(`community-programs/${p}`),S.success("Community program deleted successfully!",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}),this.fetchCommunityPrograms({page:1,itemsPerPage:this.itemsPerPage})}catch(r){const i=r.response?.data?.message||"Failed to delete community program. Please try again.";S.error(i,{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}},async bulkDeleteCommunityPrograms(p){try{const r=p.map(i=>F.delete(`community-programs/${i}`));await Promise.all(r),S.success(`${p.length} community programs deleted successfully!`,{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}),this.fetchCommunityPrograms({page:1,itemsPerPage:this.itemsPerPage})}catch{S.error("Failed to delete selected community programs. Please try again.",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}},async toggleStatus(p){try{const r=await F.post(`community-programs/${p}/toggle-status`);S.success("Community program status updated successfully!",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}),this.fetchCommunityPrograms({page:1,itemsPerPage:this.itemsPerPage})}catch(r){const i=r.response?.data?.message||"Failed to update community program status. Please try again.";S.error(i,{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}},async getPublishedCommunityPrograms({page:p=1,itemsPerPage:r=10}){try{const i=new URLSearchParams({page:p,perPage:r,search:this.communityProgramsSearch});return(await F.get(`community-programs/published?${i}`)).data}catch{return{success:!1,data:[],meta:{total:0}}}},getStatusLabel(p){const r=this.statusOptions.find(i=>i.value===p);return r?r.label:p},formatDate(p){return p?new Date(p).toLocaleDateString():""},resetCurrentCommunityProgram(){this.currentCommunityProgram={id:null,title:"",slug:"",description:"",target_group:"general_community",program_type:"education",location:"",partner_organizations:[],featured_image:"",cover_image:"",thumbnail_image:"",status:"draft"}}}});const ke={class:"flex w-100"},Ie={class:"flex w-100"},ze={class:"flex w-100"},Ue={class:"flex w-100 image-upload-row mb-4"},we={class:"w-50 image-upload-wrapper"},Oe={class:"image-upload-label mb-3 d-block"},Se=["src"],Ee={class:"photo-overlay"},Me={class:"w-50 image-upload-wrapper"},Te={class:"image-upload-label mb-3 d-block"},Re=["src"],je={class:"photo-overlay"},Be={class:"flex w-100 image-upload-row mb-4"},xe={class:"w-100 image-upload-wrapper"},De={class:"image-upload-label mb-3 d-block"},Fe=["src"],He={class:"photo-overlay"},Ae={class:"w-100"},Le={class:"w-100"},qe={class:"translation-field mb-4"},Ne={class:"translation-field mb-4"},Ge={__name:"CreateCommunityProgramTranslatable",setup(p){const{t:r}=ve(),i=_e(),u=H(()=>i.isEditMode?r("update"):r("create")),j=H(()=>i.isEditMode?r("update"):r("submit")),A=f(!1),ae=["title","description","target_group","partner_organizations"],a=K({id:null,title:"",slug:"",description:"",target_group:"general_community",program_type:"education",location:"",partner_organizations:[],status:"draft",featured_image:"",cover_image:"",thumbnail_image:""}),k=f(null),C=f(null),L=f(null),le=f(null),I=f(null),M=f(null),q=f(null),oe=f(null),z=f(null),T=f(null),N=f(null),v=f(null),c=H(()=>C.value||a.featured_image||null),R=H(()=>M.value||a.cover_image||null),D=H(()=>T.value||a.thumbnail_image||null);re(k,e=>{if(e&&e instanceof File){if(!["image/png","image/jpeg","image/jpg","image/webp"].includes(e.type)){alert(r("please_select_image")||"Please select a valid image file"),k.value=null,C.value=null;return}if(e.size>3*1024*1024){alert(r("image_too_large")||"Image size must be less than 3MB"),k.value=null,C.value=null;return}a.featured_image="";const m=new FileReader;m.onload=t=>{C.value=t.target.result},m.onerror=()=>{C.value=null},m.readAsDataURL(e)}else e||a.featured_image||(C.value=null)}),re(I,e=>{if(e&&e instanceof File){if(!["image/png","image/jpeg","image/jpg","image/webp"].includes(e.type)){alert(r("please_select_image")||"Please select a valid image file"),I.value=null,M.value=null;return}if(e.size>3*1024*1024){alert(r("image_too_large")||"Image size must be less than 3MB"),I.value=null,M.value=null;return}a.cover_image="";const m=new FileReader;m.onload=t=>{M.value=t.target.result},m.onerror=()=>{M.value=null},m.readAsDataURL(e)}else e||a.cover_image||(M.value=null)}),re(z,e=>{if(e&&e instanceof File){if(!["image/png","image/jpeg","image/jpg","image/webp"].includes(e.type)){alert(r("please_select_image")||"Please select a valid image file"),z.value=null,T.value=null;return}if(e.size>3*1024*1024){alert(r("image_too_large")||"Image size must be less than 3MB"),z.value=null,T.value=null;return}a.thumbnail_image="";const m=new FileReader;m.onload=t=>{T.value=t.target.result},m.onerror=()=>{T.value=null},m.readAsDataURL(e)}else e||a.thumbnail_image||(T.value=null)}),re(()=>i.currentCommunityProgram,e=>{e&&Object.keys(e).length>0&&(a.id=e.id,a.title=e.title||"",a.slug=e.slug||"",a.description=e.description||"",a.target_group=e.target_group||"general_community",a.program_type=e.program_type||"education",a.location=e.location||"",a.partner_organizations=e.partner_organizations||[],a.status=e.status||"draft",a.featured_image=e.featured_image||"",a.cover_image=e.cover_image||"",a.thumbnail_image=e.thumbnail_image||"",k.value=null,C.value=a.featured_image||null,le.value=a.featured_image||null,I.value=null,M.value=a.cover_image||null,oe.value=a.cover_image||null,z.value=null,T.value=a.thumbnail_image||null,v.value=a.thumbnail_image||null,a.translationData={...e,farsi_translations:e.farsi_translations||{},pashto_translations:e.pashto_translations||{}})},{deep:!0,immediate:!0});const G={required:e=>!!e||r("field_required")},W=()=>{a.title&&!a.slug&&(a.slug=a.title.toLowerCase().replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim("-"))},Q=()=>{L.value?.click()},se=e=>{e&&e.target&&e.target.files&&e.target.files.length>0&&(k.value=e.target.files[0])},Y=()=>{k.value=null,C.value=null,a.featured_image="",L.value&&(L.value.value="")},X=()=>{q.value?.click()},Z=e=>{e&&e.target&&e.target.files&&e.target.files.length>0&&(I.value=e.target.files[0])},ie=()=>{I.value=null,M.value=null,a.cover_image="",q.value&&(q.value.value="")},ee=()=>{N.value?.click()},ne=e=>{e&&e.target&&e.target.files&&e.target.files.length>0&&(z.value=e.target.files[0])},ue=()=>{z.value=null,T.value=null,a.thumbnail_image="",N.value&&(N.value.value="")},de=async({data:e})=>{A.value=!0;try{const o=new FormData;if(Object.keys(e).forEach(m=>{if(m!=="featured_image"&&m!=="cover_image"&&m!=="thumbnail_image")if(m==="translations"){const t={...e[m]},g=U=>Array.isArray(U)?U.map(B=>typeof B=="object"&&B!==null&&"value"in B?B.value:B).filter(B=>B!=null&&B!==""):U;["farsi","pashto"].forEach(U=>{t[U]&&t[U].partner_organizations&&(t[U].partner_organizations=g(t[U].partner_organizations))}),o.append(m,JSON.stringify(t))}else m==="partner_organizations"&&Array.isArray(e[m])?e[m].map(g=>typeof g=="object"&&g!==null&&"value"in g?g.value:g).filter(g=>g!=null&&g!=="").forEach((g,U)=>{o.append(`${m}[${U}]`,g)}):e[m]!==null&&e[m]!==void 0&&o.append(m,e[m])}),k.value?o.append("featured_image",k.value):i.isEditMode&&!C.value&&!k.value&&le.value?o.append("featured_image",""):a.featured_image&&!a.featured_image.startsWith("data:")&&!k.value?o.append("featured_image",a.featured_image):i.isEditMode||o.append("featured_image",""),I.value?o.append("cover_image",I.value):i.isEditMode&&!M.value&&!I.value&&oe.value?o.append("cover_image",""):a.cover_image&&!a.cover_image.startsWith("data:")&&!I.value?o.append("cover_image",a.cover_image):i.isEditMode||o.append("cover_image",""),z.value?o.append("thumbnail_image",z.value):i.isEditMode&&!T.value&&!z.value&&v.value?o.append("thumbnail_image",""):a.thumbnail_image&&!a.thumbnail_image.startsWith("data:")&&!z.value?o.append("thumbnail_image",a.thumbnail_image):i.isEditMode||o.append("thumbnail_image",""),i.isEditMode){const m=await i.updateCommunityProgram(a.id,o),t=m?.data?.data||m?.data||{};k.value&&t.featured_image&&(a.featured_image=t.featured_image,C.value=t.featured_image,k.value=null),I.value&&t.cover_image&&(a.cover_image=t.cover_image,M.value=t.cover_image,I.value=null),z.value&&t.thumbnail_image&&(a.thumbnail_image=t.thumbnail_image,T.value=t.thumbnail_image,z.value=null)}else await i.createCommunityProgram(o)}finally{A.value=!1}};return(e,o)=>{const m=h("v-text-field"),t=h("v-select"),g=h("v-icon"),U=h("v-combobox"),B=h("v-textarea");return y(),te($e,{modelValue:V(i).createDialog,"onUpdate:modelValue":o[3]||(o[3]=d=>V(i).createDialog=d),"form-title":u.value,"button-text":j.value,"translatable-fields":ae,"form-data":a,rules:G,saving:A.value,"is-edit-mode":V(i).isEditMode,onSave:de},{"base-fields":n(({formData:d,rules:O})=>[s("div",ke,[l(m,{modelValue:d.title,"onUpdate:modelValue":_=>d.title=_,variant:"outlined",label:e.$t("title"),density:"compact",class:"pb-4 pr-2 w-75",rules:[O.required],onInput:W},null,8,["modelValue","onUpdate:modelValue","label","rules"]),l(t,{modelValue:d.status,"onUpdate:modelValue":_=>d.status=_,items:V(i).statusOptions,variant:"outlined",density:"compact","item-value":"value","item-title":"label","return-object":!1,label:e.$t("status"),class:"pb-4 pl-2 w-25",rules:[O.required]},null,8,["modelValue","onUpdate:modelValue","items","label","rules"])]),s("div",Ie,[l(m,{modelValue:d.slug,"onUpdate:modelValue":_=>d.slug=_,variant:"outlined",label:e.$t("slug"),density:"compact",class:"pb-4 pr-2 w-50",hint:e.$t("hint_url_friendly"),"persistent-hint":""},null,8,["modelValue","onUpdate:modelValue","label","hint"]),l(t,{modelValue:d.program_type,"onUpdate:modelValue":_=>d.program_type=_,items:V(i).programTypeOptions,variant:"outlined",density:"compact","item-value":"value","item-title":"label","return-object":!1,label:e.$t("program_type"),class:"pb-4 pl-2 w-50",rules:[O.required]},null,8,["modelValue","onUpdate:modelValue","items","label","rules"])]),s("div",ze,[l(t,{modelValue:d.target_group,"onUpdate:modelValue":_=>d.target_group=_,items:V(i).targetGroupOptions,variant:"outlined",density:"compact","item-value":"value","item-title":"label","return-object":!1,label:e.$t("target_group"),class:"pb-4 pr-2 w-50",rules:[O.required]},null,8,["modelValue","onUpdate:modelValue","items","label","rules"]),l(m,{modelValue:d.location,"onUpdate:modelValue":_=>d.location=_,variant:"outlined",label:e.$t("location"),density:"compact",class:"pb-4 pl-2 w-50"},null,8,["modelValue","onUpdate:modelValue","label"])]),s("div",Ue,[s("div",we,[s("label",Oe,P(e.$t("featured_image")),1),s("div",{class:"photo-upload-container",onClick:o[0]||(o[0]=_=>!c.value&&Q())},[s("input",{ref_key:"featuredImageInputRef",ref:L,type:"file",accept:"image/png, image/jpeg, image/jpg, image/webp",style:{display:"none"},onChange:se},null,544),me(s("img",{src:c.value,class:"photo-preview"},null,8,Se),[[ge,c.value!==null]]),s("div",Ee,[c.value?E("",!0):(y(),w("button",{key:0,type:"button",onClick:x(Q,["stop"]),class:"overlay-button"},[l(g,{size:"x-large",color:"blue-grey-lighten-2"},{default:n(()=>[...o[4]||(o[4]=[b("mdi-camera",-1)])]),_:1})])),c.value?(y(),w("button",{key:1,type:"button",onClick:x(Y,["stop"]),class:"close-button"},[l(g,{size:"lg",color:"red"},{default:n(()=>[...o[5]||(o[5]=[b("mdi-close",-1)])]),_:1})])):E("",!0),c.value?(y(),w("button",{key:2,type:"button",onClick:x(Q,["stop"]),class:"edit-button"},[l(g,{size:"small"},{default:n(()=>[...o[6]||(o[6]=[b("mdi-pencil",-1)])]),_:1})])):E("",!0)])])]),s("div",Me,[s("label",Te,P(e.$t("cover_image")),1),s("div",{class:"photo-upload-container",onClick:o[1]||(o[1]=_=>!R.value&&X())},[s("input",{ref_key:"coverImageInputRef",ref:q,type:"file",accept:"image/png, image/jpeg, image/jpg, image/webp",style:{display:"none"},onChange:Z},null,544),me(s("img",{src:R.value,class:"photo-preview"},null,8,Re),[[ge,R.value!==null]]),s("div",je,[R.value?E("",!0):(y(),w("button",{key:0,type:"button",onClick:x(X,["stop"]),class:"overlay-button"},[l(g,{size:"x-large",color:"blue-grey-lighten-2"},{default:n(()=>[...o[7]||(o[7]=[b("mdi-camera",-1)])]),_:1})])),R.value?(y(),w("button",{key:1,type:"button",onClick:x(ie,["stop"]),class:"close-button"},[l(g,{size:"lg",color:"red"},{default:n(()=>[...o[8]||(o[8]=[b("mdi-close",-1)])]),_:1})])):E("",!0),R.value?(y(),w("button",{key:2,type:"button",onClick:x(X,["stop"]),class:"edit-button"},[l(g,{size:"small"},{default:n(()=>[...o[9]||(o[9]=[b("mdi-pencil",-1)])]),_:1})])):E("",!0)])])])]),s("div",Be,[s("div",xe,[s("label",De,P(e.$t("thumbnail_image")),1),s("div",{class:"photo-upload-container",onClick:o[2]||(o[2]=_=>!D.value&&ee())},[s("input",{ref_key:"thumbnailImageInputRef",ref:N,type:"file",accept:"image/png, image/jpeg, image/jpg, image/webp",style:{display:"none"},onChange:ne},null,544),me(s("img",{src:D.value,class:"photo-preview"},null,8,Fe),[[ge,D.value!==null]]),s("div",He,[D.value?E("",!0):(y(),w("button",{key:0,type:"button",onClick:x(ee,["stop"]),class:"overlay-button"},[l(g,{size:"x-large",color:"blue-grey-lighten-2"},{default:n(()=>[...o[10]||(o[10]=[b("mdi-camera",-1)])]),_:1})])),D.value?(y(),w("button",{key:1,type:"button",onClick:x(ue,["stop"]),class:"close-button"},[l(g,{size:"lg",color:"red"},{default:n(()=>[...o[11]||(o[11]=[b("mdi-close",-1)])]),_:1})])):E("",!0),D.value?(y(),w("button",{key:2,type:"button",onClick:x(ee,["stop"]),class:"edit-button"},[l(g,{size:"small"},{default:n(()=>[...o[12]||(o[12]=[b("mdi-pencil",-1)])]),_:1})])):E("",!0)])])])]),s("div",Ae,[l(U,{modelValue:d.partner_organizations,"onUpdate:modelValue":_=>d.partner_organizations=_,variant:"outlined",label:e.$t("partner_organizations"),density:"compact",class:"pb-4",multiple:"",chips:"",hint:e.$t("hint_partner_organizations"),"persistent-hint":""},null,8,["modelValue","onUpdate:modelValue","label","hint"])]),s("div",Le,[l(B,{modelValue:d.description,"onUpdate:modelValue":_=>d.description=_,variant:"outlined",label:e.$t("description"),density:"compact",class:"pb-4",rules:[O.required],rows:"8",hint:e.$t("hint_detailed_description"),"persistent-hint":""},null,8,["modelValue","onUpdate:modelValue","label","rules","hint"])])]),"farsi-fields":n(({translations:d,clearTranslation:O,hasTranslation:_})=>[l(J,{modelValue:d.title,"onUpdate:modelValue":$=>d.title=$,"field-name":"title","field-label":e.$t("title"),language:"farsi","language-label":e.$t("dari"),"has-translation":_("title"),onClear:O},null,8,["modelValue","onUpdate:modelValue","field-label","language-label","has-translation","onClear"]),l(J,{modelValue:d.description,"onUpdate:modelValue":$=>d.description=$,"field-name":"description","field-label":e.$t("description"),language:"farsi","language-label":e.$t("dari"),"field-type":"textarea",rows:8,"has-translation":_("description"),onClear:O},null,8,["modelValue","onUpdate:modelValue","field-label","language-label","has-translation","onClear"]),l(J,{modelValue:d.target_group,"onUpdate:modelValue":$=>d.target_group=$,"field-name":"target_group","field-label":e.$t("target_group"),language:"farsi","language-label":e.$t("dari"),"has-translation":_("target_group"),onClear:O},null,8,["modelValue","onUpdate:modelValue","field-label","language-label","has-translation","onClear"]),s("div",qe,[l(U,{modelValue:d.partner_organizations,"onUpdate:modelValue":$=>d.partner_organizations=$,variant:"outlined",label:e.$t("partner_organizations"),density:"compact",class:"pb-4",multiple:"",chips:"",hint:e.$t("hint_partner_organizations"),"persistent-hint":""},null,8,["modelValue","onUpdate:modelValue","label","hint"])])]),"pashto-fields":n(({translations:d,clearTranslation:O,hasTranslation:_})=>[l(J,{modelValue:d.title,"onUpdate:modelValue":$=>d.title=$,"field-name":"title","field-label":e.$t("title"),language:"pashto","language-label":e.$t("pashto"),"has-translation":_("title"),onClear:O},null,8,["modelValue","onUpdate:modelValue","field-label","language-label","has-translation","onClear"]),l(J,{modelValue:d.description,"onUpdate:modelValue":$=>d.description=$,"field-name":"description","field-label":e.$t("description"),language:"pashto","language-label":e.$t("pashto"),"field-type":"textarea",rows:8,"has-translation":_("description"),onClear:O},null,8,["modelValue","onUpdate:modelValue","field-label","language-label","has-translation","onClear"]),l(J,{modelValue:d.target_group,"onUpdate:modelValue":$=>d.target_group=$,"field-name":"target_group","field-label":e.$t("target_group"),language:"pashto","language-label":e.$t("pashto"),"has-translation":_("target_group"),onClear:O},null,8,["modelValue","onUpdate:modelValue","field-label","language-label","has-translation","onClear"]),s("div",Ne,[l(U,{modelValue:d.partner_organizations,"onUpdate:modelValue":$=>d.partner_organizations=$,variant:"outlined",label:e.$t("partner_organizations"),density:"compact",class:"pb-4",multiple:"",chips:"",hint:e.$t("hint_partner_organizations"),"persistent-hint":""},null,8,["modelValue","onUpdate:modelValue","label","hint"])])]),_:1},8,["modelValue","form-title","button-text","form-data","saving","is-edit-mode"])}}},We=ce(Ge,[["__scopeId","data-v-cf2e0d2a"]]),Ye=["dir"],Je={class:"btn-search pt-12 pb-6"},Ke={class:"text-field w-25"},Qe={class:"btn flex"},Xe={class:"table-section"},Ze={class:"text-center pa-4"},et={class:"py-2 pl-4"},tt={class:"d-flex align-center"},at={class:"font-weight-medium"},lt={class:"text-caption text-grey"},ot={class:"py-2 pl-4"},rt={class:"py-2 pl-4"},st={class:"py-2 pl-4"},it={class:"py-2 pl-4"},nt={class:"py-2 pl-4"},ut={key:0},dt={key:0,class:"text-caption"},mt={key:1},gt={__name:"CommunityPrograms",setup(p){const{t:r,locale:i}=ve();Ve();const u=_e(),j=H(()=>["fa","pa"].includes(i.value)?"rtl":"ltr"),A=f("");let ae;const a=()=>{clearTimeout(ae),ae=setTimeout(()=>{u.fetchCommunityPrograms({page:1,itemsPerPage:u.itemsPerPage,status:A.value})},500)},k=v=>{u.fetchCommunityPrograms({page:v.page,itemsPerPage:v.itemsPerPage,status:A.value})},C=f([]),L=()=>{C.value.length>0&&(u.bulkDeleteCommunityPrograms(C.value),C.value=[])},le=()=>{u.resetCurrentCommunityProgram(),u.isEditMode=!1,u.createDialog=!0},I=v=>{u.isEditMode=!0,u.currentCommunityProgram={...v},u.createDialog=!0},M=async v=>{await u.deleteCommunityProgram(v.id)},q=async v=>{await u.toggleStatus(v.id)},oe=v=>{switch(v){case"published":return"success";case"draft":return"warning";case"ongoing":return"info";case"completed":return"primary";case"cancelled":return"error";default:return"primary"}},z=v=>{const c=u.programTypeOptions.find(R=>R.value===v);return c?c.label:v},T=v=>{const c=u.targetGroupOptions.find(R=>R.value===v);return c?c.label:v},N=H(()=>[{title:"",key:"checkbox",align:"start",sortable:!1},{title:r("title"),key:"title",align:"start",sortable:!0},{title:r("program_type"),key:"program_type",align:"center",sortable:!0},{title:r("target_group"),key:"target_group",align:"center",sortable:!0},{title:r("status"),key:"status",align:"center",sortable:!0},{title:r("location"),key:"location",align:"center",sortable:!0},{title:r("partner_organizations"),key:"partner_organizations",align:"center",sortable:!1},{title:r("action"),key:"action",align:"center",sortable:!1}]);return be(()=>{u.fetchCommunityPrograms({page:1,itemsPerPage:u.itemsPerPage})}),(v,c)=>{const R=h("v-divider"),D=h("v-text-field"),G=h("v-btn"),W=h("v-icon"),Q=h("v-img"),se=h("v-avatar"),Y=h("v-chip"),X=h("v-checkbox"),Z=h("v-list-item-title"),ie=h("v-list-item"),ee=h("v-list"),ne=h("v-menu"),ue=h("v-data-table-server"),de=h("v-col"),e=h("v-row"),o=h("v-main"),m=h("v-app");return y(),w(pe,null,[V(u).createDialog?(y(),te(We,{key:0})):E("",!0),s("div",{dir:j.value},[l(Pe,{pageTitle:v.$t("community_programs_management")},null,8,["pageTitle"]),l(R,{thickness:1,class:"border-opacity-100"}),s("div",Je,[s("div",Ke,[l(D,{color:"primary",density:"compact",variant:"outlined",label:v.$t("search"),"append-inner-icon":"mdi-magnify","hide-details":"",modelValue:V(u).communityProgramsSearch,"onUpdate:modelValue":c[0]||(c[0]=t=>V(u).communityProgramsSearch=t),onInput:a},null,8,["label","modelValue"])]),s("div",Qe,[l(G,{variant:"outlined",color:"primary",class:"px-6"},{default:n(()=>[b(P(V(r)("filter")),1)]),_:1}),c[4]||(c[4]=b(" Â  ",-1)),l(G,{onClick:le,class:"create-btn-gradient px-6",text:v.$t("create")},{default:n(()=>[l(W,null,{default:n(()=>[...c[3]||(c[3]=[b("mdi-plus",-1)])]),_:1})]),_:1},8,["text"])])]),s("div",Xe,[l(m,null,{default:n(()=>[l(o,{class:"main"},{default:n(()=>[l(e,null,{default:n(()=>[l(de,null,{default:n(()=>[l(ue,{dir:j.value,theme:"cursor-pointer","items-per-page":V(u).itemsPerPage,"onUpdate:itemsPerPage":c[2]||(c[2]=t=>V(u).itemsPerPage=t),headers:N.value,"items-length":V(u).totalItems,items:V(u).communityPrograms,loading:V(u).loading,"onUpdate:options":k,hover:"",class:"w-100 mx-auto"},{"no-data":n(()=>[s("div",Ze,P(v.$t("no_data_available")),1)]),"item.title":n(({item:t})=>[s("td",et,[s("div",tt,[t.featured_image?(y(),te(se,{key:0,size:"40",class:"mr-3"},{default:n(()=>[l(Q,{src:t.featured_image,alt:t.title},null,8,["src","alt"])]),_:2},1024)):E("",!0),s("div",null,[s("div",at,P(t.title),1),s("div",lt,P(t.location),1)])])])]),"item.program_type":n(({item:t})=>[s("td",ot,[l(Y,{color:"primary",size:"small",variant:"outlined"},{default:n(()=>[b(P(z(t.program_type)),1)]),_:2},1024)])]),"item.target_group":n(({item:t})=>[s("td",rt,[l(Y,{color:"secondary",size:"small",variant:"outlined"},{default:n(()=>[b(P(T(t.target_group)),1)]),_:2},1024)])]),"item.status":n(({item:t})=>[s("td",st,[l(Y,{color:oe(t.status),size:"small",variant:"flat"},{default:n(()=>[b(P(V(u).getStatusLabel(t.status)),1)]),_:2},1032,["color"])])]),"item.location":n(({item:t})=>[s("td",it,[s("span",null,P(t.location||"N/A"),1)])]),"item.partner_organizations":n(({item:t})=>[s("td",nt,[t.partner_organizations&&t.partner_organizations.length>0?(y(),w("div",ut,[(y(!0),w(pe,null,Ce(t.partner_organizations.slice(0,2),g=>(y(),te(Y,{key:g,size:"x-small",class:"mr-1"},{default:n(()=>[b(P(g),1)]),_:2},1024))),128)),t.partner_organizations.length>2?(y(),w("span",dt," +"+P(t.partner_organizations.length-2)+" more ",1)):E("",!0)])):(y(),w("span",mt,"N/A"))])]),"item.checkbox":n(({item:t})=>[l(X,{value:t.id,modelValue:C.value,"onUpdate:modelValue":c[1]||(c[1]=g=>C.value=g),class:"w-6 d-flex"},null,8,["value","modelValue"])]),"item.action":n(({item:t})=>[l(ne,null,{activator:n(({props:g})=>[l(G,ye({icon:"mdi-dots-vertical"},g,{variant:"text"}),null,16)]),default:n(()=>[l(ee,null,{default:n(()=>[l(ie,null,{default:n(()=>[l(Z,{onClick:g=>I(t),class:"cursor-pointer d-flex gap-3 justify-left pb-3"},{default:n(()=>[l(W,{color:"tealColor"},{default:n(()=>[...c[5]||(c[5]=[b("mdi-square-edit-outline",-1)])]),_:1}),b(" "+P(v.$t("edit")),1)]),_:1},8,["onClick"]),l(Z,{onClick:g=>q(t),class:"cursor-pointer d-flex gap-3 pb-3"},{default:n(()=>[l(W,{color:t.status==="published"?"orange":"green"},{default:n(()=>[b(P(t.status==="published"?"mdi-eye-off":"mdi-eye"),1)]),_:2},1032,["color"]),b(" "+P(t.status==="published"?"Unpublish":"Publish"),1)]),_:2},1032,["onClick"]),l(Z,{class:"cursor-pointer d-flex gap-3",onClick:g=>M(t)},{default:n(()=>[l(W,{color:"error"},{default:n(()=>[...c[6]||(c[6]=[b("mdi-delete-outline",-1)])]),_:1}),b(" "+P(v.$t("delete")),1)]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1},8,["dir","items-per-page","headers","items-length","items","loading"]),C.value.length>0?(y(),te(G,{key:0,class:"header-button",onClick:L,color:"#B71C1C",flat:"",inset:"",text:`Delete ${C.value.length} selected`},null,8,["text"])):E("",!0)]),_:1})]),_:1})]),_:1})]),_:1})])],8,Ye)],64)}}},bt=ce(gt,[["__scopeId","data-v-76a49490"]]);export{bt as default};
