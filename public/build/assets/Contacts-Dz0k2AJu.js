import{al as pe,i as $,N as D,r as f,G as ve,q as _e,c as B,o as ge,h as d,b as S,j as y,d as t,g as n,u as p,w as o,z as j,f as b,l as _,t as r,a0 as fe,F as he}from"./_plugin-vue_export-helper-P6s7mfAX.js";import{H as ye}from"./Header-Dc2gjrUc.js";import{l as m,u as be,a as ke}from"./admin-C1tUPR0Q.js";/* empty css                                                               *//* empty css              */let Ce=pe("ContactsRepository",{state(){return{router:ve(),search:f(""),loadingTable:f(!0),loading:f(!0),totalItems:f(0),selectedItems:f([]),itemsPerPage:f(15),contacts:D([]),contactSearch:f(""),currentContact:D({}),statusOptionsBase:[{value:"",labelKey:"all_status"},{value:"new",labelKey:"new"},{value:"read",labelKey:"read"},{value:"replied",labelKey:"replied"},{value:"archived",labelKey:"archived"}],subjectOptionsBase:[{value:"",labelKey:"all_types"},{value:"job_application",labelKey:"contact.job_application"},{value:"general_inquiry",labelKey:"contact.general_inquiry"},{value:"project_discussion",labelKey:"contact.project_discussion"},{value:"technical_support",labelKey:"contact.technical_support"},{value:"partnership",labelKey:"contact.partnership"},{value:"media_inquiry",labelKey:"contact.media_inquiry"},{value:"other",labelKey:"contact.other"}]}},actions:{getStatusLabel(u,a){const v=a||(g=>g),s=this.statusOptionsBase.find(g=>g.value===u);return s?v(s.labelKey):u},getSubjectLabel(u,a){const v=a||(g=>g),s=this.subjectOptionsBase.find(g=>g.value===u);return s?v(s.labelKey):u},async fetchContacts({page:u=1,itemsPerPage:a=15,status:v="",subject:s=""}){this.loading=!0;try{const g={page:u,perPage:a,search:this.contactSearch,status:v,subject:s},h=await $.get("contacts",{params:g});h.data.success?(this.contacts=h.data.data,this.totalItems=h.data.meta.total):m.error("Failed to fetch contacts")}catch{m.error("Error fetching contacts")}finally{this.loading=!1}},async getContact(u){this.loading=!0;try{const a=await $.get(`contacts/${u}`);if(a.data.success)return this.currentContact=a.data.data,a.data.data;m.error("Failed to fetch contact")}catch{m.error("Error fetching contact")}finally{this.loading=!1}},async updateContactStatus(u,a){try{const v=await $.patch(`contacts/${u}`,{status:a});if(v.data.success)return m.success("Contact updated successfully"),this.fetchContacts({page:1,itemsPerPage:this.itemsPerPage}),v.data.data;m.error("Failed to update contact")}catch(v){v.response?.data?.message?m.error(v.response.data.message):m.error("Error updating contact")}},async markAsRead(u){try{const a=await $.patch(`contacts/${u}/mark-as-read`);if(a.data.success)return m.success("Contact marked as read"),this.fetchContacts({page:1,itemsPerPage:this.itemsPerPage}),a.data.data;m.error("Failed to mark contact as read")}catch{m.error("Error marking contact as read")}},async markAsReplied(u){try{const a=await $.patch(`contacts/${u}/mark-as-replied`);if(a.data.success)return m.success("Contact marked as replied"),this.fetchContacts({page:1,itemsPerPage:this.itemsPerPage}),a.data.data;m.error("Failed to mark contact as replied")}catch{m.error("Error marking contact as replied")}},async deleteContact(u){try{(await $.delete(`contacts/${u}`)).data.success?(m.success("Contact deleted successfully"),this.fetchContacts({page:1,itemsPerPage:this.itemsPerPage})):m.error("Failed to delete contact")}catch(a){a.response?.data?.message?m.error(a.response.data.message):m.error("Error deleting contact")}},async bulkDeleteContacts(u){try{const a=u.map(v=>$.delete(`contacts/${v}`));await Promise.all(a),m.success(`${u.length} contact(s) deleted successfully`),this.fetchContacts({page:1,itemsPerPage:this.itemsPerPage})}catch{m.error("Error deleting contacts")}},resetCurrentContact(){this.currentContact={}}}});const Pe=["dir"],xe={class:"btn-search pt-12 pb-6"},$e={class:"text-field w-25"},we={class:"flex gap-2"},je={class:"table-section"},Se={class:"py-2 pl-4 d-flex align-center"},Ve={class:"font-weight-medium"},Ke={class:"text-caption text-grey"},Ee={class:"py-2 pl-4"},Be={class:"py-2 pl-4"},Re={class:"py-2 pl-4"},Fe={class:"text-caption text-truncate",style:{"max-width":"300px"}},Ie={class:"py-2 pl-4"},Oe={class:"text-caption"},Te={class:"space-y-4"},Ue={class:"text-sm font-medium text-grey-darken-1"},Ae={class:"text-body-1"},De={class:"text-sm font-medium text-grey-darken-1"},Le={class:"text-body-1"},qe=["href"],ze={key:0},Ne={class:"text-sm font-medium text-grey-darken-1"},He={class:"text-body-1"},Ge=["href"],Me={class:"text-sm font-medium text-grey-darken-1"},Je={class:"text-body-1"},Qe={key:1},We={class:"text-sm font-medium text-grey-darken-1"},Xe={class:"text-body-1"},Ye={class:"text-sm font-medium text-grey-darken-1"},Ze={class:"text-body-1"},et={key:2},tt={class:"text-sm font-medium text-grey-darken-1"},at={class:"text-body-1"},st={key:3},lt={class:"text-sm font-medium text-grey-darken-1"},ot={class:"text-body-1"},rt=["href"],nt={class:"text-sm font-medium text-grey-darken-1"},ct={class:"text-body-1"},it={class:"text-sm font-medium text-grey-darken-1"},dt={class:"text-body-1"},ut={__name:"Contacts",setup(u){const{t:a,locale:v}=be();ke();const s=Ce(),g=B(()=>["fa","ps"].includes(v.value)?"rtl":"ltr"),h=f(""),P=f(""),k=f(!1),c=f(null),L=B(()=>s.statusOptionsBase.map(e=>({value:e.value,label:a(e.labelKey)}))),q=B(()=>s.subjectOptionsBase.map(e=>({value:e.value,label:a(e.labelKey)})));ge(()=>{s.fetchContacts({page:1,itemsPerPage:s.itemsPerPage,status:h.value,type:P.value})});let F;const z=()=>{clearTimeout(F),F=setTimeout(()=>{s.fetchContacts({page:1,itemsPerPage:s.itemsPerPage,status:h.value,subject:P.value})},500)},N=()=>{s.fetchContacts({page:1,itemsPerPage:s.itemsPerPage,status:h.value,type:P.value})},H=()=>{s.fetchContacts({page:1,itemsPerPage:s.itemsPerPage,status:h.value,type:P.value})},G=e=>{s.fetchContacts({page:e.page,itemsPerPage:e.itemsPerPage,status:h.value,type:P.value})},C=f([]),M=()=>{C.value.length>0&&confirm(a("confirm_delete_contacts",{count:C.value.length}))&&(s.bulkDeleteContacts(C.value),C.value=[])},J=async e=>{await s.getContact(e.id),c.value=s.currentContact,k.value=!0},I=async e=>{await s.markAsRead(e.id),k.value&&c.value?.id===e.id&&(c.value.status="read")},O=async e=>{await s.markAsReplied(e.id),k.value&&c.value?.id===e.id&&(c.value.status="replied")},Q=async e=>{confirm(a("confirm_delete_contact"))&&(await s.deleteContact(e.id),k.value&&c.value?.id===e.id&&(k.value=!1,c.value=null))},T=e=>{switch(e){case"new":return"error";case"read":return"warning";case"replied":return"success";case"archived":return"grey";default:return"primary"}},U=e=>new Date(e).toLocaleDateString(),W=B(()=>[{title:"",key:"checkbox",align:"start",sortable:!1},{title:a("name"),key:"name",align:"start",sortable:!1},{title:a("subject"),key:"subject",align:"start",sortable:!1},{title:a("status"),key:"status",align:"start",sortable:!1},{title:a("message"),key:"message",align:"start",sortable:!1},{title:a("created_at"),key:"created_at",align:"start",sortable:!1},{title:a("action"),key:"action",align:"end",sortable:!1}]);return(e,i)=>{const R=d("v-divider"),X=d("v-text-field"),A=d("v-select"),V=d("v-chip"),Y=d("v-checkbox"),w=d("v-btn"),K=d("v-icon"),E=d("v-list-item-title"),Z=d("v-list-item"),ee=d("v-list"),te=d("v-menu"),ae=d("v-data-table-server"),se=d("v-col"),le=d("v-row"),oe=d("v-main"),re=d("v-app"),ne=d("v-card-title"),ce=d("v-card-text"),ie=d("v-spacer"),de=d("v-card-actions"),ue=d("v-card"),me=d("v-dialog");return y(),S(he,null,[t("div",{dir:g.value},[n(ye,{pageTitle:e.$t("contacts_management")},null,8,["pageTitle"]),n(R,{thickness:1,class:"border-opacity-100"}),t("div",xe,[t("div",$e,[n(X,{color:"primary",density:"compact",variant:"outlined",label:e.$t("search"),"append-inner-icon":"mdi-magnify","hide-details":"",modelValue:p(s).contactSearch,"onUpdate:modelValue":i[0]||(i[0]=l=>p(s).contactSearch=l),onInput:z},null,8,["label","modelValue"])]),t("div",we,[n(A,{modelValue:h.value,"onUpdate:modelValue":[i[1]||(i[1]=l=>h.value=l),N],items:L.value,variant:"outlined",density:"compact","item-value":"value","item-title":"label",label:e.$t("status"),class:"text-field"},null,8,["modelValue","items","label"]),n(A,{modelValue:P.value,"onUpdate:modelValue":[i[2]||(i[2]=l=>P.value=l),H],items:q.value,variant:"outlined",density:"compact","item-value":"value","item-title":"label",label:e.$t("subject"),class:"text-field"},null,8,["modelValue","items","label"])])]),t("div",je,[n(re,null,{default:o(()=>[n(oe,{class:"main"},{default:o(()=>[n(le,null,{default:o(()=>[n(se,null,{default:o(()=>[n(ae,{dir:g.value,theme:"cursor-pointer","items-per-page":p(s).itemsPerPage,"onUpdate:itemsPerPage":i[4]||(i[4]=l=>p(s).itemsPerPage=l),headers:W.value,"items-length":p(s).totalItems,items:p(s).contacts,loading:p(s).loading,"onUpdate:options":G,hover:"",class:"w-100 mx-auto"},{"item.name":o(({item:l})=>[t("div",Se,[t("div",null,[t("div",Ve,r(l.name),1),t("div",Ke,r(l.email),1)])])]),"item.subject":o(({item:l})=>[t("div",Ee,[n(V,{size:"small",variant:"outlined",color:"primary"},{default:o(()=>[_(r(p(s).getSubjectLabel(l.subject,p(a))),1)]),_:2},1024)])]),"item.status":o(({item:l})=>[t("div",Be,[n(V,{color:T(l.status),size:"small",variant:"flat"},{default:o(()=>[_(r(p(s).getStatusLabel(l.status,p(a))),1)]),_:2},1032,["color"])])]),"item.message":o(({item:l})=>[t("div",Re,[t("div",Fe,r(l.message?.substring(0,80))+r(l.message?.length>80?"...":""),1)])]),"item.created_at":o(({item:l})=>[t("div",Ie,[t("div",Oe,r(U(l.created_at)),1)])]),"item.checkbox":o(({item:l})=>[n(Y,{value:l.id,modelValue:C.value,"onUpdate:modelValue":i[3]||(i[3]=x=>C.value=x),class:"w-6 d-flex"},null,8,["value","modelValue"])]),"item.action":o(({item:l})=>[n(te,null,{activator:o(({props:x})=>[n(w,fe({icon:"mdi-dots-vertical"},x,{variant:"text"}),null,16)]),default:o(()=>[n(ee,null,{default:o(()=>[n(Z,null,{default:o(()=>[n(E,{onClick:x=>J(l),class:"cursor-pointer d-flex gap-3 justify-left pb-3"},{default:o(()=>[n(K,{color:"primary"},{default:o(()=>[...i[10]||(i[10]=[_("mdi-eye",-1)])]),_:1}),_(" "+r(e.$t("view")),1)]),_:1},8,["onClick"]),l.status==="new"?(y(),j(E,{key:0,onClick:x=>I(l),class:"cursor-pointer d-flex gap-3 pb-3"},{default:o(()=>[n(K,{color:"info"},{default:o(()=>[...i[11]||(i[11]=[_("mdi-email-mark-as-unread",-1)])]),_:1}),_(" "+r(e.$t("mark_as_read")),1)]),_:1},8,["onClick"])):b("",!0),l.status!=="replied"?(y(),j(E,{key:1,onClick:x=>O(l),class:"cursor-pointer d-flex gap-3 pb-3"},{default:o(()=>[n(K,{color:"success"},{default:o(()=>[...i[12]||(i[12]=[_("mdi-reply",-1)])]),_:1}),_(" "+r(e.$t("mark_as_replied")),1)]),_:1},8,["onClick"])):b("",!0),n(E,{class:"cursor-pointer d-flex gap-3",onClick:x=>Q(l)},{default:o(()=>[n(K,{color:"error"},{default:o(()=>[...i[13]||(i[13]=[_("mdi-delete-outline",-1)])]),_:1}),_(" "+r(e.$t("delete")),1)]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1},8,["dir","items-per-page","headers","items-length","items","loading"]),C.value.length>0?(y(),j(w,{key:0,class:"header-button",onClick:M,color:"#B71C1C",flat:"",inset:"",text:p(a)("delete_selected",{count:C.value.length})},null,8,["text"])):b("",!0)]),_:1})]),_:1})]),_:1})]),_:1})])],8,Pe),n(me,{modelValue:k.value,"onUpdate:modelValue":i[9]||(i[9]=l=>k.value=l),"max-width":"800",persistent:""},{default:o(()=>[c.value?(y(),j(ue,{key:0},{default:o(()=>[n(ne,{class:"d-flex justify-space-between align-center"},{default:o(()=>[t("span",null,r(e.$t("contact_details")),1),n(w,{icon:"mdi-close",variant:"text",onClick:i[5]||(i[5]=l=>k.value=!1)})]),_:1}),n(R),n(ce,{class:"pt-6"},{default:o(()=>[t("div",Te,[t("div",null,[t("label",Ue,r(e.$t("name")),1),t("p",Ae,r(c.value.name),1)]),t("div",null,[t("label",De,r(e.$t("email")),1),t("p",Le,[t("a",{href:`mailto:${c.value.email}`,class:"text-primary"},r(c.value.email),9,qe)])]),c.value.phone?(y(),S("div",ze,[t("label",Ne,r(e.$t("phone")),1),t("p",He,[t("a",{href:`tel:${c.value.phone}`,class:"text-primary"},r(c.value.phone),9,Ge)])])):b("",!0),t("div",null,[t("label",Me,r(e.$t("subject")),1),t("p",Je,[n(V,{size:"small",variant:"outlined",color:"primary"},{default:o(()=>[_(r(p(s).getSubjectLabel(c.value.subject,p(a))),1)]),_:1})])]),c.value.job_title?(y(),S("div",Qe,[t("label",We,r(e.$t("job_title")),1),t("p",Xe,r(c.value.job_title),1)])):b("",!0),t("div",null,[t("label",Ye,r(e.$t("message")),1),t("p",Ze,r(c.value.message),1)]),c.value.cover_letter?(y(),S("div",et,[t("label",tt,r(e.$t("cover_letter")),1),t("p",at,r(c.value.cover_letter),1)])):b("",!0),c.value.cv_file_path?(y(),S("div",st,[t("label",lt,r(e.$t("cv_resume")),1),t("p",ot,[t("a",{href:`/storage/${c.value.cv_file_path}`,target:"_blank",class:"text-primary"},r(e.$t("download_cv")),9,rt)])])):b("",!0),t("div",null,[t("label",nt,r(e.$t("status")),1),t("p",ct,[n(V,{color:T(c.value.status),size:"small",variant:"flat"},{default:o(()=>[_(r(p(s).getStatusLabel(c.value.status,p(a))),1)]),_:1},8,["color"])])]),t("div",null,[t("label",it,r(e.$t("submitted_at")),1),t("p",dt,r(U(c.value.created_at)),1)])])]),_:1}),n(R),n(de,null,{default:o(()=>[n(ie),c.value.status==="new"?(y(),j(w,{key:0,onClick:i[6]||(i[6]=l=>I(c.value)),color:"info"},{default:o(()=>[_(r(e.$t("mark_as_read")),1)]),_:1})):b("",!0),c.value.status!=="replied"?(y(),j(w,{key:1,onClick:i[7]||(i[7]=l=>O(c.value)),color:"success"},{default:o(()=>[_(r(e.$t("mark_as_replied")),1)]),_:1})):b("",!0),n(w,{onClick:i[8]||(i[8]=l=>k.value=!1),variant:"outlined"},{default:o(()=>[_(r(e.$t("close")),1)]),_:1})]),_:1})]),_:1})):b("",!0)]),_:1},8,["modelValue"])],64)}}},ft=_e(ut,[["__scopeId","data-v-b62424d9"]]);export{ft as default};
