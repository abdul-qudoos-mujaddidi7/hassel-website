import{al as ce,i as L,N as J,r as y,G as pe,q as ie,c as Y,y as oe,h as _,z as ee,j as z,w as d,g as t,d as i,u as C,t as U,B as ne,D as se,b as H,f as M,s as G,l as P,o as me,a0 as ge,F as ve}from"./_plugin-vue_export-helper-BPPfTR4S.js";import{H as be}from"./Header-CgJPtGh2.js";import{l as k,u as re,a as he}from"./admin-BgzI1_lQ.js";import{T as x,a as _e}from"./TranslationField-oLOc6KoU.js";/* empty css                                                               *//* empty css              */let ue=ce("EnvironmentalProjectsRepository",{state(){return{isEditMode:y(!1),router:pe(),search:y(""),loadingTable:y(!0),loading:y(!0),totalItems:y(0),selectedItems:y([]),itemsPerPage:y(5),createDialog:y(!1),environmentalProjects:J([]),environmentalProjectsSearch:y(""),currentEnvironmentalProject:J({}),statusOptions:J([{value:"draft",label:"Draft"},{value:"published",label:"Published"},{value:"ongoing",label:"Ongoing"},{value:"completed",label:"Completed"},{value:"cancelled",label:"Cancelled"}]),projectTypeOptions:J([{value:"conservation",label:"Conservation"},{value:"reforestation",label:"Reforestation"},{value:"water_management",label:"Water Management"},{value:"soil_conservation",label:"Soil Conservation"},{value:"biodiversity",label:"Biodiversity"},{value:"climate_adaptation",label:"Climate Adaptation"}]),impactLevelOptions:J([{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}])}},actions:{setEditMode(m){this.isEditMode=m},getTodaysDate(){const m=new Date,a=m.getFullYear(),n=String(m.getMonth()+1).padStart(2,"0"),r=String(m.getDate()).padStart(2,"0");return`${a}-${n}-${r}`},async fetchEnvironmentalProjects({page:m=1,itemsPerPage:a=5,status:n=""}){this.loading=!0;try{const r=new URLSearchParams({page:m,perPage:a,search:this.environmentalProjectsSearch});n&&r.append("status",n);const O=await L.get(`environmental-projects?${r}`);console.log("API Response:",O.data),O.data.success?(this.environmentalProjects=O.data.data||[],this.totalItems=O.data.meta?.total||0):(this.environmentalProjects=[],this.totalItems=0,k.error(O.data.message||"Failed to fetch data",{position:"top-right",autoClose:3e3})),this.loading=!1}catch(r){console.error("API Error:",r),console.error("Error Response:",r.response?.data),this.environmentalProjects=[],this.totalItems=0,this.loading=!1;const O=r.response?.data?.message||"Failed to fetch environmental projects";k.error(O,{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}},async fetchEnvironmentalProject(m){this.loading=!0;try{const a=await L.get(`environmental-projects/${m}`,{params:{include_translations:1}});this.currentEnvironmentalProject=a.data.data,this.loading=!1}catch(a){console.error(a),this.loading=!1,k.error("Failed to fetch environmental project",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}},async createEnvironmentalProject(m){try{const a=await L.post("environmental-projects",m);this.createDialog=!1,k.success("Environmental project created successfully!",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}),this.fetchEnvironmentalProjects({page:1,itemsPerPage:this.itemsPerPage})}catch(a){console.error(a);const n=a.response?.data?.message||"Failed to create environmental project. Please try again.";k.error(n,{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}},async updateEnvironmentalProject(m,a){try{const n=await L.post(`environmental-projects/${m}`,a,{headers:{_method:"PUT"}});return this.createDialog=!1,this.isEditMode=!1,k.success("Environmental project updated successfully!",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}),this.fetchEnvironmentalProjects({page:1,itemsPerPage:this.itemsPerPage}),n}catch(n){console.error(n);const r=n.response?.data?.message||"Failed to update environmental project. Please try again.";throw k.error(r,{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}),n}},async deleteEnvironmentalProject(m){try{await L.delete(`environmental-projects/${m}`),k.success("Environmental project deleted successfully!",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}),this.fetchEnvironmentalProjects({page:1,itemsPerPage:this.itemsPerPage})}catch(a){console.error(a);const n=a.response?.data?.message||"Failed to delete environmental project. Please try again.";k.error(n,{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}},async bulkDeleteEnvironmentalProjects(m){try{const a=m.map(n=>L.delete(`environmental-projects/${n}`));await Promise.all(a),k.success(`${m.length} environmental projects deleted successfully!`,{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}),this.fetchEnvironmentalProjects({page:1,itemsPerPage:this.itemsPerPage})}catch(a){console.error(a),k.error("Failed to delete selected environmental projects. Please try again.",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}},async toggleStatus(m){try{const a=await L.post(`environmental-projects/${m}/toggle-status`);k.success("Environmental project status updated successfully!",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}),this.fetchEnvironmentalProjects({page:1,itemsPerPage:this.itemsPerPage})}catch(a){console.error(a);const n=a.response?.data?.message||"Failed to update environmental project status. Please try again.";k.error(n,{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}},async getPublishedEnvironmentalProjects({page:m=1,itemsPerPage:a=10}){try{const n=new URLSearchParams({page:m,perPage:a,search:this.environmentalProjectsSearch});return(await L.get(`environmental-projects/published?${n}`)).data}catch(n){return console.error(n),{success:!1,data:[],meta:{total:0}}}},getStatusLabel(m){const a=this.statusOptions.find(n=>n.value===m);return a?a.label:m},formatDate(m){return m?new Date(m).toLocaleDateString():""},resetCurrentEnvironmentalProject(){this.currentEnvironmentalProject={id:null,title:"",slug:"",description:"",project_type:"conservation",location:"",start_date:null,end_date:null,budget:null,impact_level:"medium",objectives:"",methodology:"",expected_outcomes:"",partner_organizations:[],cover_image:"",thumbnail_image:"",status:"draft"}}}});const fe={class:"flex w-100"},ye={class:"flex w-100"},Ve={class:"flex w-100"},je={class:"flex w-100"},Pe={class:"flex w-100"},Ce={class:"flex w-100 image-upload-row mb-4"},$e={class:"w-50 image-upload-wrapper"},Ue={class:"image-upload-label mb-3 d-block"},Ee=["src"],we={class:"photo-overlay"},Ie={class:"w-50 image-upload-wrapper"},ke={class:"image-upload-label mb-3 d-block"},Oe=["src"],Se={class:"photo-overlay"},ze={class:"w-100"},xe={class:"w-100"},Me={class:"w-100"},Be={class:"w-100"},Re={class:"w-100"},Le={__name:"CreateEnvironmentalProjectTranslatable",setup(m){const{t:a}=re(),n=ue(),r=Y(()=>n.isEditMode?a("update"):a("create")),O=Y(()=>n.isEditMode?a("update"):a("submit")),A=y(!1),Q=["title","description","objectives","methodology","expected_outcomes"],o=J({id:null,title:"",slug:"",description:"",project_type:"conservation",location:"",start_date:null,end_date:null,budget:null,impact_level:"medium",objectives:"",methodology:"",expected_outcomes:"",partner_organizations:[],cover_image:"",thumbnail_image:"",status:"draft"}),E=y(null),V=y(null),F=y(null),X=y(null),w=y(null),S=y(null),q=y(null),Z=y(null),B=Y(()=>V.value||o.cover_image||null),R=Y(()=>S.value||o.thumbnail_image||null);oe(E,e=>{if(e&&e instanceof File){if(!["image/png","image/jpeg","image/jpg","image/webp"].includes(e.type)){alert(a("please_select_image")||"Please select a valid image file"),E.value=null,V.value=null;return}if(e.size>3*1024*1024){alert(a("image_too_large")||"Image size must be less than 3MB"),E.value=null,V.value=null;return}o.cover_image="";const c=new FileReader;c.onload=v=>{V.value=v.target.result},c.onerror=()=>{console.error("Error reading file"),V.value=null},c.readAsDataURL(e)}else e||o.cover_image||(V.value=null)}),oe(w,e=>{if(e&&e instanceof File){if(!["image/png","image/jpeg","image/jpg","image/webp"].includes(e.type)){alert(a("please_select_image")||"Please select a valid image file"),w.value=null,S.value=null;return}if(e.size>3*1024*1024){alert(a("image_too_large")||"Image size must be less than 3MB"),w.value=null,S.value=null;return}o.thumbnail_image="";const c=new FileReader;c.onload=v=>{S.value=v.target.result},c.onerror=()=>{console.error("Error reading file"),S.value=null},c.readAsDataURL(e)}else e||o.thumbnail_image||(S.value=null)}),oe(()=>n.currentEnvironmentalProject,e=>{e&&Object.keys(e).length>0&&(o.id=e.id,o.title=e.title||"",o.slug=e.slug||"",o.description=e.description||"",o.project_type=e.project_type||"conservation",o.location=e.location||"",o.start_date=e.start_date?new Date(e.start_date).toISOString().slice(0,10):null,o.end_date=e.end_date?new Date(e.end_date).toISOString().slice(0,10):null,o.budget=e.budget||null,o.impact_level=e.impact_level||"medium",o.objectives=e.objectives||"",o.methodology=e.methodology||"",o.expected_outcomes=e.expected_outcomes||"",o.partner_organizations=e.partner_organizations||[],o.cover_image=e.cover_image||"",o.thumbnail_image=e.thumbnail_image||"",o.status=e.status||"draft",E.value=null,V.value=o.cover_image||null,X.value=o.cover_image||null,w.value=null,S.value=o.thumbnail_image||null,Z.value=o.thumbnail_image||null,o.translationData={...e,farsi_translations:e.farsi_translations||{},pashto_translations:e.pashto_translations||{}})},{deep:!0,immediate:!0});const te={required:e=>!!e||a("field_required")},le=()=>{o.title&&!o.slug&&(o.slug=o.title.toLowerCase().replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim("-"))},g=()=>{F.value?.click()},b=e=>{e&&e.target&&e.target.files&&e.target.files.length>0&&(E.value=e.target.files[0])},T=()=>{E.value=null,V.value=null,o.cover_image="",F.value&&(F.value.value="")},K=()=>{q.value?.click()},N=e=>{e&&e.target&&e.target.files&&e.target.files.length>0&&(w.value=e.target.files[0])},D=()=>{w.value=null,S.value=null,o.thumbnail_image="",q.value&&(q.value.value="")},ae=async({data:e})=>{A.value=!0;try{const u=new FormData;if(Object.keys(e).forEach(c=>{if(c!=="cover_image"&&c!=="thumbnail_image")if(c==="translations"){const v={...e[c]},h=I=>Array.isArray(I)?I.map($=>typeof $=="object"&&$!==null&&"value"in $?$.value:$).filter($=>$!=null&&$!==""):I;["farsi","pashto"].forEach(I=>{v[I]&&v[I].partner_organizations&&(v[I].partner_organizations=h(v[I].partner_organizations))}),u.append(c,JSON.stringify(v))}else c==="partner_organizations"&&Array.isArray(e[c])?e[c].map(h=>typeof h=="object"&&h!==null&&"value"in h?h.value:h).filter(h=>h!=null&&h!=="").forEach((h,I)=>{u.append(`${c}[${I}]`,h)}):c==="start_date"||c==="end_date"?e[c]&&u.append(c,new Date(e[c]).toISOString().split("T")[0]):e[c]!==null&&e[c]!==void 0&&u.append(c,e[c])}),E.value?u.append("cover_image",E.value):n.isEditMode&&!V.value&&!E.value&&X.value?u.append("cover_image",""):o.cover_image&&!o.cover_image.startsWith("data:")&&!E.value?u.append("cover_image",o.cover_image):n.isEditMode||u.append("cover_image",""),w.value?u.append("thumbnail_image",w.value):n.isEditMode&&!S.value&&!w.value&&Z.value?u.append("thumbnail_image",""):o.thumbnail_image&&!o.thumbnail_image.startsWith("data:")&&!w.value?u.append("thumbnail_image",o.thumbnail_image):n.isEditMode||u.append("thumbnail_image",""),n.isEditMode){const c=await n.updateEnvironmentalProject(o.id,u),v=c?.data?.data||c?.data||{};E.value&&v.cover_image&&(o.cover_image=v.cover_image,V.value=v.cover_image,E.value=null),w.value&&v.thumbnail_image&&(o.thumbnail_image=v.thumbnail_image,S.value=v.thumbnail_image,w.value=null)}else await n.createEnvironmentalProject(u)}finally{A.value=!1}};return(e,u)=>{const c=_("v-text-field"),v=_("v-select"),h=_("v-icon"),I=_("v-combobox"),$=_("v-textarea");return z(),ee(_e,{modelValue:C(n).createDialog,"onUpdate:modelValue":u[2]||(u[2]=l=>C(n).createDialog=l),"form-title":r.value,"button-text":O.value,"translatable-fields":Q,"form-data":o,rules:te,saving:A.value,"is-edit-mode":C(n).isEditMode,onSave:ae},{"base-fields":d(({formData:l,rules:j})=>[i("div",fe,[t(c,{modelValue:l.title,"onUpdate:modelValue":s=>l.title=s,variant:"outlined",label:e.$t("title"),density:"compact",class:"pb-4 pr-2 w-75",rules:[j.required],onInput:le},null,8,["modelValue","onUpdate:modelValue","label","rules"]),t(v,{modelValue:l.status,"onUpdate:modelValue":s=>l.status=s,items:C(n).statusOptions,variant:"outlined",density:"compact","item-value":"value","item-title":"label","return-object":!1,label:e.$t("status"),class:"pb-4 pl-2 w-25",rules:[j.required]},null,8,["modelValue","onUpdate:modelValue","items","label","rules"])]),i("div",ye,[t(c,{modelValue:l.slug,"onUpdate:modelValue":s=>l.slug=s,variant:"outlined",label:e.$t("slug"),density:"compact",class:"pb-4 pr-2 w-50",hint:e.$t("hint_url_friendly"),"persistent-hint":""},null,8,["modelValue","onUpdate:modelValue","label","hint"]),t(v,{modelValue:l.project_type,"onUpdate:modelValue":s=>l.project_type=s,items:C(n).projectTypeOptions,variant:"outlined",density:"compact","item-value":"value","item-title":"label","return-object":!1,label:e.$t("project_type"),class:"pb-4 pl-2 w-50",rules:[j.required]},null,8,["modelValue","onUpdate:modelValue","items","label","rules"])]),i("div",Ve,[t(c,{modelValue:l.location,"onUpdate:modelValue":s=>l.location=s,variant:"outlined",label:e.$t("location"),density:"compact",class:"pb-4 pr-2 w-50"},null,8,["modelValue","onUpdate:modelValue","label"]),t(v,{modelValue:l.impact_level,"onUpdate:modelValue":s=>l.impact_level=s,items:C(n).impactLevelOptions,variant:"outlined",density:"compact","item-value":"value","item-title":"label","return-object":!1,label:e.$t("impact_level"),class:"pb-4 pl-2 w-50"},null,8,["modelValue","onUpdate:modelValue","items","label"])]),i("div",je,[t(c,{modelValue:l.start_date,"onUpdate:modelValue":s=>l.start_date=s,variant:"outlined",label:e.$t("start_date"),density:"compact",type:"date",class:"pb-4 pr-2 w-50"},null,8,["modelValue","onUpdate:modelValue","label"]),t(c,{modelValue:l.end_date,"onUpdate:modelValue":s=>l.end_date=s,variant:"outlined",label:e.$t("end_date"),density:"compact",type:"date",class:"pb-4 pl-2 w-50"},null,8,["modelValue","onUpdate:modelValue","label"])]),i("div",Pe,[t(c,{modelValue:l.budget,"onUpdate:modelValue":s=>l.budget=s,variant:"outlined",label:e.$t("budget"),density:"compact",type:"number",class:"pb-4 w-100",hint:e.$t("hint_budget_usd"),"persistent-hint":""},null,8,["modelValue","onUpdate:modelValue","label","hint"])]),i("div",Ce,[i("div",$e,[i("label",Ue,U(e.$t("cover_image")),1),i("div",{class:"photo-upload-container",onClick:u[0]||(u[0]=s=>!B.value&&g())},[i("input",{ref_key:"coverImageInputRef",ref:F,type:"file",accept:"image/png, image/jpeg, image/jpg, image/webp",style:{display:"none"},onChange:b},null,544),ne(i("img",{src:B.value,class:"photo-preview"},null,8,Ee),[[se,B.value!==null]]),i("div",we,[B.value?M("",!0):(z(),H("button",{key:0,type:"button",onClick:G(g,["stop"]),class:"overlay-button"},[t(h,{size:"x-large",color:"blue-grey-lighten-2"},{default:d(()=>[...u[3]||(u[3]=[P("mdi-camera",-1)])]),_:1})])),B.value?(z(),H("button",{key:1,type:"button",onClick:G(T,["stop"]),class:"close-button"},[t(h,{size:"lg",color:"red"},{default:d(()=>[...u[4]||(u[4]=[P("mdi-close",-1)])]),_:1})])):M("",!0),B.value?(z(),H("button",{key:2,type:"button",onClick:G(g,["stop"]),class:"edit-button"},[t(h,{size:"small"},{default:d(()=>[...u[5]||(u[5]=[P("mdi-pencil",-1)])]),_:1})])):M("",!0)])])]),i("div",Ie,[i("label",ke,U(e.$t("thumbnail_image")),1),i("div",{class:"photo-upload-container",onClick:u[1]||(u[1]=s=>!R.value&&K())},[i("input",{ref_key:"thumbnailImageInputRef",ref:q,type:"file",accept:"image/png, image/jpeg, image/jpg, image/webp",style:{display:"none"},onChange:N},null,544),ne(i("img",{src:R.value,class:"photo-preview"},null,8,Oe),[[se,R.value!==null]]),i("div",Se,[R.value?M("",!0):(z(),H("button",{key:0,type:"button",onClick:G(K,["stop"]),class:"overlay-button"},[t(h,{size:"x-large",color:"blue-grey-lighten-2"},{default:d(()=>[...u[6]||(u[6]=[P("mdi-camera",-1)])]),_:1})])),R.value?(z(),H("button",{key:1,type:"button",onClick:G(D,["stop"]),class:"close-button"},[t(h,{size:"lg",color:"red"},{default:d(()=>[...u[7]||(u[7]=[P("mdi-close",-1)])]),_:1})])):M("",!0),R.value?(z(),H("button",{key:2,type:"button",onClick:G(K,["stop"]),class:"edit-button"},[t(h,{size:"small"},{default:d(()=>[...u[8]||(u[8]=[P("mdi-pencil",-1)])]),_:1})])):M("",!0)])])])]),i("div",ze,[t(I,{modelValue:l.partner_organizations,"onUpdate:modelValue":s=>l.partner_organizations=s,variant:"outlined",label:e.$t("partner_organizations"),density:"compact",class:"pb-4",multiple:"",chips:"",hint:e.$t("hint_partner_organizations"),"persistent-hint":""},null,8,["modelValue","onUpdate:modelValue","label","hint"])]),i("div",xe,[t($,{modelValue:l.description,"onUpdate:modelValue":s=>l.description=s,variant:"outlined",label:e.$t("description"),density:"compact",class:"pb-4",rules:[j.required],rows:"6",hint:e.$t("hint_environmental_description"),"persistent-hint":""},null,8,["modelValue","onUpdate:modelValue","label","rules","hint"])]),i("div",Me,[t($,{modelValue:l.objectives,"onUpdate:modelValue":s=>l.objectives=s,variant:"outlined",label:e.$t("objectives"),density:"compact",class:"pb-4",rows:"4",hint:e.$t("hint_project_objectives"),"persistent-hint":""},null,8,["modelValue","onUpdate:modelValue","label","hint"])]),i("div",Be,[t($,{modelValue:l.methodology,"onUpdate:modelValue":s=>l.methodology=s,variant:"outlined",label:e.$t("methodology"),density:"compact",class:"pb-4",rows:"4",hint:e.$t("hint_project_methodology"),"persistent-hint":""},null,8,["modelValue","onUpdate:modelValue","label","hint"])]),i("div",Re,[t($,{modelValue:l.expected_outcomes,"onUpdate:modelValue":s=>l.expected_outcomes=s,variant:"outlined",label:e.$t("expected_outcomes"),density:"compact",class:"pb-4",rows:"4",hint:e.$t("hint_project_outcomes"),"persistent-hint":""},null,8,["modelValue","onUpdate:modelValue","label","hint"])])]),"farsi-fields":d(({translations:l,clearTranslation:j,hasTranslation:s})=>[t(x,{modelValue:l.title,"onUpdate:modelValue":f=>l.title=f,"field-name":"title","field-label":e.$t("title"),language:"farsi","language-label":e.$t("dari"),"has-translation":s("title"),onClear:j},null,8,["modelValue","onUpdate:modelValue","field-label","language-label","has-translation","onClear"]),t(x,{modelValue:l.description,"onUpdate:modelValue":f=>l.description=f,"field-name":"description","field-label":e.$t("description"),language:"farsi","language-label":e.$t("dari"),"field-type":"textarea",rows:6,"has-translation":s("description"),onClear:j},null,8,["modelValue","onUpdate:modelValue","field-label","language-label","has-translation","onClear"]),t(x,{modelValue:l.objectives,"onUpdate:modelValue":f=>l.objectives=f,"field-name":"objectives","field-label":e.$t("objectives"),language:"farsi","language-label":e.$t("dari"),"field-type":"textarea",rows:4,"has-translation":s("objectives"),onClear:j},null,8,["modelValue","onUpdate:modelValue","field-label","language-label","has-translation","onClear"]),t(x,{modelValue:l.methodology,"onUpdate:modelValue":f=>l.methodology=f,"field-name":"methodology","field-label":e.$t("methodology"),language:"farsi","language-label":e.$t("dari"),"field-type":"textarea",rows:4,"has-translation":s("methodology"),onClear:j},null,8,["modelValue","onUpdate:modelValue","field-label","language-label","has-translation","onClear"]),t(x,{modelValue:l.expected_outcomes,"onUpdate:modelValue":f=>l.expected_outcomes=f,"field-name":"expected_outcomes","field-label":e.$t("expected_outcomes"),language:"farsi","language-label":e.$t("dari"),"field-type":"textarea",rows:4,"has-translation":s("expected_outcomes"),onClear:j},null,8,["modelValue","onUpdate:modelValue","field-label","language-label","has-translation","onClear"])]),"pashto-fields":d(({translations:l,clearTranslation:j,hasTranslation:s})=>[t(x,{modelValue:l.title,"onUpdate:modelValue":f=>l.title=f,"field-name":"title","field-label":e.$t("title"),language:"pashto","language-label":e.$t("pashto"),"has-translation":s("title"),onClear:j},null,8,["modelValue","onUpdate:modelValue","field-label","language-label","has-translation","onClear"]),t(x,{modelValue:l.description,"onUpdate:modelValue":f=>l.description=f,"field-name":"description","field-label":e.$t("description"),language:"pashto","language-label":e.$t("pashto"),"field-type":"textarea",rows:6,"has-translation":s("description"),onClear:j},null,8,["modelValue","onUpdate:modelValue","field-label","language-label","has-translation","onClear"]),t(x,{modelValue:l.objectives,"onUpdate:modelValue":f=>l.objectives=f,"field-name":"objectives","field-label":e.$t("objectives"),language:"pashto","language-label":e.$t("pashto"),"field-type":"textarea",rows:4,"has-translation":s("objectives"),onClear:j},null,8,["modelValue","onUpdate:modelValue","field-label","language-label","has-translation","onClear"]),t(x,{modelValue:l.methodology,"onUpdate:modelValue":f=>l.methodology=f,"field-name":"methodology","field-label":e.$t("methodology"),language:"pashto","language-label":e.$t("pashto"),"field-type":"textarea",rows:4,"has-translation":s("methodology"),onClear:j},null,8,["modelValue","onUpdate:modelValue","field-label","language-label","has-translation","onClear"]),t(x,{modelValue:l.expected_outcomes,"onUpdate:modelValue":f=>l.expected_outcomes=f,"field-name":"expected_outcomes","field-label":e.$t("expected_outcomes"),language:"pashto","language-label":e.$t("pashto"),"field-type":"textarea",rows:4,"has-translation":s("expected_outcomes"),onClear:j},null,8,["modelValue","onUpdate:modelValue","field-label","language-label","has-translation","onClear"])]),_:1},8,["modelValue","form-title","button-text","form-data","saving","is-edit-mode"])}}},Te=ie(Le,[["__scopeId","data-v-9e58ce70"]]),He=["dir"],Ae={class:"btn-search pt-12 pb-6"},Fe={class:"text-field w-25"},qe={class:"btn flex"},Ne={class:"table-section"},De={class:"text-center pa-4"},We={class:"py-2 pl-4"},Ge={class:"d-flex align-center"},Je={class:"font-weight-medium"},Ye={class:"text-caption text-grey"},Ke={class:"py-2 pl-4"},Qe={class:"py-2 pl-4"},Xe={class:"py-2 pl-4"},Ze={class:"py-2 pl-4"},et={class:"py-2 pl-4"},tt={__name:"EnvironmentalProjects",setup(m){const{t:a,locale:n}=re();he();const r=ue(),O=Y(()=>["fa","pa"].includes(n.value)?"rtl":"ltr"),A=y("");let Q;const o=()=>{clearTimeout(Q),Q=setTimeout(()=>{r.fetchEnvironmentalProjects({page:1,itemsPerPage:r.itemsPerPage,status:A.value})},500)},E=g=>{r.fetchEnvironmentalProjects({page:g.page,itemsPerPage:g.itemsPerPage,status:A.value})},V=y([]),F=()=>{V.value.length>0&&(r.bulkDeleteEnvironmentalProjects(V.value),V.value=[])},X=()=>{r.resetCurrentEnvironmentalProject(),r.isEditMode=!1,r.createDialog=!0},w=g=>{r.isEditMode=!0,r.currentEnvironmentalProject={...g},r.createDialog=!0},S=async g=>{await r.deleteEnvironmentalProject(g.id)},q=async g=>{await r.toggleStatus(g.id)},Z=g=>{switch(g){case"published":return"success";case"draft":return"warning";case"ongoing":return"info";case"completed":return"primary";case"cancelled":return"error";default:return"primary"}},B=g=>{switch(g){case"low":return"success";case"medium":return"warning";case"high":return"orange";case"critical":return"error";default:return"primary"}},R=g=>{const b=r.projectTypeOptions.find(T=>T.value===g);return b?b.label:g},te=g=>{const b=r.impactLevelOptions.find(T=>T.value===g);return b?b.label:g},le=Y(()=>[{title:"",key:"checkbox",align:"start",sortable:!1},{title:a("title"),key:"title",align:"start",sortable:!0},{title:a("project_type"),key:"project_type",align:"center",sortable:!0},{title:a("status"),key:"status",align:"center",sortable:!0},{title:a("impact_level"),key:"impact_level",align:"center",sortable:!0},{title:a("start_date"),key:"start_date",align:"center",sortable:!0},{title:a("budget"),key:"budget",align:"center",sortable:!0},{title:a("action"),key:"action",align:"center",sortable:!1}]);return me(()=>{r.fetchEnvironmentalProjects({page:1,itemsPerPage:r.itemsPerPage})}),(g,b)=>{const T=_("v-divider"),K=_("v-text-field"),N=_("v-btn"),D=_("v-icon"),ae=_("v-img"),e=_("v-avatar"),u=_("v-chip"),c=_("v-checkbox"),v=_("v-list-item-title"),h=_("v-list-item"),I=_("v-list"),$=_("v-menu"),l=_("v-data-table-server"),j=_("v-col"),s=_("v-row"),f=_("v-main"),de=_("v-app");return z(),H(ve,null,[C(r).createDialog?(z(),ee(Te,{key:0})):M("",!0),i("div",{dir:O.value},[t(be,{pageTitle:g.$t("environmental_projects_management")},null,8,["pageTitle"]),t(T,{thickness:1,class:"border-opacity-100"}),i("div",Ae,[i("div",Fe,[t(K,{color:"primary",density:"compact",variant:"outlined",label:g.$t("search"),"append-inner-icon":"mdi-magnify","hide-details":"",modelValue:C(r).environmentalProjectsSearch,"onUpdate:modelValue":b[0]||(b[0]=p=>C(r).environmentalProjectsSearch=p),onInput:o},null,8,["label","modelValue"])]),i("div",qe,[t(N,{variant:"outlined",color:"primary",class:"px-6"},{default:d(()=>[P(U(C(a)("filter")),1)]),_:1}),b[4]||(b[4]=P(" Â  ",-1)),t(N,{onClick:X,class:"create-btn-gradient px-6",text:g.$t("create")},{default:d(()=>[t(D,null,{default:d(()=>[...b[3]||(b[3]=[P("mdi-plus",-1)])]),_:1})]),_:1},8,["text"])])]),i("div",Ne,[t(de,null,{default:d(()=>[t(f,{class:"main"},{default:d(()=>[t(s,null,{default:d(()=>[t(j,null,{default:d(()=>[t(l,{dir:O.value,theme:"cursor-pointer","items-per-page":C(r).itemsPerPage,"onUpdate:itemsPerPage":b[2]||(b[2]=p=>C(r).itemsPerPage=p),headers:le.value,"items-length":C(r).totalItems,items:C(r).environmentalProjects,loading:C(r).loading,"onUpdate:options":E,hover:"",class:"w-100 mx-auto"},{"no-data":d(()=>[i("div",De,U(g.$t("no_data_available")),1)]),"item.title":d(({item:p})=>[i("td",We,[i("div",Ge,[p.cover_image?(z(),ee(e,{key:0,size:"40",class:"mr-3"},{default:d(()=>[t(ae,{src:p.cover_image,alt:p.title},null,8,["src","alt"])]),_:2},1024)):M("",!0),i("div",null,[i("div",Je,U(p.title),1),i("div",Ye,U(p.location),1)])])])]),"item.project_type":d(({item:p})=>[i("td",Ke,[t(u,{color:"primary",size:"small",variant:"outlined"},{default:d(()=>[P(U(R(p.project_type)),1)]),_:2},1024)])]),"item.status":d(({item:p})=>[i("td",Qe,[t(u,{color:Z(p.status),size:"small",variant:"flat"},{default:d(()=>[P(U(C(r).getStatusLabel(p.status)),1)]),_:2},1032,["color"])])]),"item.impact_level":d(({item:p})=>[i("td",Xe,[t(u,{color:B(p.impact_level),size:"small",variant:"flat"},{default:d(()=>[P(U(te(p.impact_level)),1)]),_:2},1032,["color"])])]),"item.start_date":d(({item:p})=>[i("td",Ze,[i("span",null,U(C(r).formatDate(p.start_date)),1)])]),"item.budget":d(({item:p})=>[i("td",et,[i("span",null,U(p.budget?"$"+p.budget.toLocaleString():"N/A"),1)])]),"item.checkbox":d(({item:p})=>[t(c,{value:p.id,modelValue:V.value,"onUpdate:modelValue":b[1]||(b[1]=W=>V.value=W),class:"w-6 d-flex"},null,8,["value","modelValue"])]),"item.action":d(({item:p})=>[t($,null,{activator:d(({props:W})=>[t(N,ge({icon:"mdi-dots-vertical"},W,{variant:"text"}),null,16)]),default:d(()=>[t(I,null,{default:d(()=>[t(h,null,{default:d(()=>[t(v,{onClick:W=>w(p),class:"cursor-pointer d-flex gap-3 justify-left pb-3"},{default:d(()=>[t(D,{color:"tealColor"},{default:d(()=>[...b[5]||(b[5]=[P("mdi-square-edit-outline",-1)])]),_:1}),P(" "+U(g.$t("edit")),1)]),_:1},8,["onClick"]),t(v,{onClick:W=>q(p),class:"cursor-pointer d-flex gap-3 pb-3"},{default:d(()=>[t(D,{color:p.status==="published"?"orange":"green"},{default:d(()=>[P(U(p.status==="published"?"mdi-eye-off":"mdi-eye"),1)]),_:2},1032,["color"]),P(" "+U(p.status==="published"?"Unpublish":"Publish"),1)]),_:2},1032,["onClick"]),t(v,{class:"cursor-pointer d-flex gap-3",onClick:W=>S(p)},{default:d(()=>[t(D,{color:"error"},{default:d(()=>[...b[6]||(b[6]=[P("mdi-delete-outline",-1)])]),_:1}),P(" "+U(g.$t("delete")),1)]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1},8,["dir","items-per-page","headers","items-length","items","loading"]),V.value.length>0?(z(),ee(N,{key:0,class:"header-button",onClick:F,color:"#B71C1C",flat:"",inset:"",text:`Delete ${V.value.length} selected`},null,8,["text"])):M("",!0)]),_:1})]),_:1})]),_:1})]),_:1})])],8,He)],64)}}},rt=ie(tt,[["__scopeId","data-v-53303bff"]]);export{rt as default};
